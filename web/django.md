# Django

## Framework

- ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ë¹ ë¥´ê²Œ ê°œë°œí•  ìˆ˜ ìˆë„ë¡ ë„ì™€ì£¼ëŠ” ë„êµ¬
- ê°œë°œì— í•„ìš”í•œ ê¸°ë³¸ êµ¬ì¡°, ê·œì¹™, ë¼ì´ë¸ŒëŸ¬ë¦¬ ë“±ì„ ì œê³µ

### Frameworkë¥¼ ì‚¬ìš©í•˜ëŠ” ì´ìœ 

- ê¸°ë³¸ì ì¸ êµ¬ì¡°, ë„êµ¬, ê·œì¹™  ë“±ì„ ì œê³µí•˜ê¸° ë•Œë¬¸ì— ê°œë°œìëŠ” í”¼ë£»ì ì¸ í•´ì•¼ í•˜ëŠ” í•µì‹¬ ê°œë°œì—ë§Œ ì§‘ì¤‘ í•  ìˆ˜ ìˆìŒ
- ì—¬ëŸ¬ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì œê³µí•´ ê°œë°œ ì†ë„ë¥¼ ë¹ ë¥´ê²Œ í•  ìˆ˜ ìˆìŒ(ìƒì‚°ì„±)
- ìœ ì§€ë³´ìˆ˜ì™€ í™•ì¥ì— ìš©ì´í•´ ì†Œí”„íŠ¸ì›¨ì–´ì˜ í’ˆì§ˆì„ ë†’ì„

## Django

- Python ê¸°ë°˜ì˜ ëŒ€í‘œì ì¸ ì›¹ í”„ë ˆì„ì›Œí¬
- ê²€ì¦ëœ ì›¹ í”„ë ˆì„ì›Œí¬
- ëŒ€ê·œëª¨ ì„œë¹„ìŠ¤ì—ì„œë„ ì•ˆì •ì ì¸ ì„œë¹„ìŠ¤ ì œê³µ

## í´ë¼ì´ì–¸íŠ¸ì™€ ì„œë²„

### ì›¹ì˜ ë™ì‘ ë°©ì‹

![Untitled](https://github.com/yuj1818/TIL/assets/95585314/6425c9ba-69f5-4b6a-9471-19f7987a38be)

- í´ë¼ì´ì–¸íŠ¸(Client)
    - ì„œë¹„ìŠ¤ë¥¼ ìš”ì²­í•˜ëŠ” ì£¼ì²´
    - ì›¹ ì‚¬ìš©ìì˜ ì¸í„°ë„·ì´ ì—°ê²°ëœ ì¥ì¹˜, ì›¹ ë¸Œë¼ìš°ì €
- ì„œë²„(Server)
    - í´ë¼ì´ì–¸íŠ¸ì˜ ìš”ì²­ì— ì‘ë‹µí•˜ëŠ” ì£¼ì²´
    - ì›¹ í˜ì´ì§€, ì•±ì„ ì €ì¥í•˜ëŠ” ì»´í“¨í„°
- â­ìš°ë¦¬ê°€ ì›¹ í˜ì´ì§€ë¥¼ ë³´ê²Œ ë˜ëŠ” ê³¼ì •â­
    - ì›¹ ë¸Œë¼ìš°ì €(í´ë¼ì´ì–¸íŠ¸)ì—ì„œ google.comì„ ì…ë ¥
    - ë¸Œë¼ìš°ì €ëŠ” ì¸í„°ë„·ì— ì—°ê²°ëœ ì „ì„¸ê³„ ì–´ë”˜ ê°€ì— ìˆëŠ” êµ¬ê¸€ ì»´í“¨í„°(ì„œë²„)ì—ê²Œ â€˜Google í™ˆí˜ì´ì§€.htmlâ€™ íŒŒì¼ì„ ë‹¬ë¼ê³  ìš”ì²­
    - ìš”ì²­ì„ ë°›ì€ êµ¬ê¸€ ì»´í“¨í„°ëŠ” ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ â€˜Google í™ˆí˜ì´ì§€.htmlâ€™ íŒŒì¼ì„ ì°¾ì•„ ì‘ë‹µ
    - ì „ë‹¬ë°›ì€ Google í™ˆí˜ì´ì§€.html íŒŒì¼ì„ ì›¹ ë¸Œë¼ìš°ì €ê°€ ì‚¬ëŒì´ ë³¼ ìˆ˜ ìˆë„ë¡ í•´ì„í•´ì£¼ë©´ì„œ ì‚¬ìš©ìëŠ” êµ¬ê¸€ì˜ ë©”ì¸ í˜ì´ì§€ë¥¼ ë³´ê²Œ ë¨

 

## í”„ë¡œì íŠ¸ ë° ê°€ìƒí™˜ê²½

### ê°€ìƒ í™˜ê²½

- Python ì• í”Œë¦¬ì¼€ì´ì…˜ê³¼ ê·¸ì— ë”°ë¥¸ íŒ¨í‚¤ì§€ë“¤ì„ ê²©ë¦¬í•˜ì—¬ ê´€ë¦¬í•  ìˆ˜ ìˆëŠ” **ë…ë¦½ì ì¸** ì‹¤í–‰ í™˜ê²½
- ê°€ìƒ í™˜ê²½ì´ í•„ìš”í•œ ê²½ìš°
    - í•œ ê°œë°œìê°€ 2ê°œì˜ í”„ë¡œì íŠ¸ë¥¼ ì§„í–‰í•˜ëŠ”ë° ê° í”„ë¡œì íŠ¸ì— ì‚¬ìš©í•´ì•¼í•˜ëŠ” requests íŒ¨í‚¤ì§€ ë²„ì „ì´ ë‹¤ë¥´ê¸° ë•Œë¬¸ì— íŒŒì´ì¬ í™˜ê²½ì—ì„œëŠ” ë‘ê°€ì§€ ë²„ì „ì´ ì–‘ë¦½í•  ìˆ˜ ì—†ì–´ ë…ë¦½ì ì¸ ê°œë°œ í™˜ê²½ì´ í•„ìš”
    - í•œ ê°œë°œìê°€ 2ê°œì˜ í”„ë¡œì íŠ¸ë¥¼ ì§„í–‰í•˜ëŠ”ë° ê° í”„ë¡œì íŠ¸ì—ì„œ ì‚¬ìš©í•´ì•¼í•˜ëŠ” íŒ¨í‚¤ì§€ê°€ í•¨ê»˜ ì‚¬ìš©í•˜ë©´ ì¶©ëŒì´ ë°œìƒí•˜ëŠ” ê²½ìš° ë…ë¦½ì ì¸ ê°œë°œ í™˜ê²½ì´ í•„ìš”

#### ê°€ìƒ í™˜ê²½ venv ìƒì„±

```bash
$ python -m venv venv
```

#### ê°€ìƒ í™˜ê²½ í™œì„±í™”

- globalì—ì„œ ê°€ìƒ í™˜ê²½ìœ¼ë¡œ ì´ë™í•˜ëŠ” ê²ƒì´ ì•„ë‹Œ **í™œì„±í™”**

```bash
$ source venv/Scripts/activate
```

#### í™˜ê²½ì— ì„¤ì¹˜ëœ íŒ¨í‚¤ì§€ ëª©ë¡ í™•ì¸

```bash
$ pip list
```

- 2ëª…ì˜ ê°œë°œìê°€ í•˜ë‚˜ì˜ í”„ë¡œì íŠ¸ë¥¼ í•¨ê»˜ ê°œë°œí•˜ëŠ” ê²½ìš°, ì„œë¡œ ì–´ë–¤ íŒ¨í‚¤ì§€ë¥¼ ì„¤ì¹˜í–ˆê³ , ì–´ë–¤ ë²„ì „ì„ ì„¤ì¹˜í–ˆëŠ”ì§€ íŒŒì•…í•˜ê³  ìˆì–´ì•¼ í•˜ë¯€ë¡œ íŒ¨í‚¤ì§€ ëª©ë¡ì´ ê³µìœ ë˜ì–´ì•¼ í•¨

### ì˜ì¡´ì„± íŒ¨í‚¤ì§€

- í•œ ì†Œí”„íŠ¸ì›¨ì–´ íŒ¨í‚¤ì§€ê°€ ë‹¤ë¥¸ íŒ¨í‚¤ì§€ì˜ ê¸°ëŠ¥ì´ë‚˜ ì½”ë“œë¥¼ ì‚¬ìš©í•˜ê¸° ë•Œë¬¸ì— ê·¸ íŒ¨í‚¤ì§€ê°€ ì¡´ì¬í•´ì•¼ë§Œ ì œëŒ€ë¡œ ì‘ë™í•˜ëŠ” ê´€ê³„
- ì‚¬ìš©í•˜ë ¤ëŠ” íŒ¨í‚¤ì§€ê°€ ì„¤ì¹˜ë˜ì§€ ì•Šì•˜ê±°ë‚˜, í˜¸í™˜ë˜ëŠ” ë²„ì „ì´ ì•„ë‹ˆë©´ ì˜¤ë¥˜ê°€ ë°œìƒí•˜ê±°ë‚˜ ì˜ˆìƒì¹˜ ëª»í•œ ë™ì‘ì„ ë³´ì¼ ìˆ˜ ìˆìŒ
- ê°œë°œ í™˜ê²½ì—ì„œëŠ” ê°ê°ì˜ í”„ë¡œì íŠ¸ê°€ ì‚¬ìš©í•˜ëŠ” íŒ¨í‚¤ì§€ì™€ ê·¸ ë²„ì „ì„ ì •í™•íˆ ê´€ë¦¬í•œëŠ ê²ƒì´ ì¤‘ìš”
- ê°€ìƒí™˜ê²½ & ì˜ì¡´ì„± íŒ¨í‚¤ì§€ ê´€ë¦¬

#### ì˜ì¡´ì„± íŒ¨í‚¤ì§€ ëª©ë¡ ìƒì„±

```bash
$ pip freeze > requirements.txt
```

### Django í”„ë¡œì íŠ¸ ìƒì„± ì „ ë£¨í‹´

```bash
# 1. ê°€ìƒí™˜ê²½(venv) ìƒì„±
$ python -m venv venv

# 2. ê°€ìƒí™˜ê²½ í™œì„±í™”
$ source venv/Scripts/activate

# 3. Django ì„¤ì¹˜
$ pip install Django

# 4. ì˜ì¡´ì„± íŒŒì¼ ìƒì„±
$ pip freeze > requirements.txt
```

### Django í”„ë¡œì íŠ¸ ìƒì„±

```bash
# firstpjtë¼ëŠ” ì´ë¦„ì˜ í”„ë¡œì íŠ¸ë¥¼ ìƒì„±
$ django-admin startproject firstpjt .
```

### Django ì„œë²„ ì‹¤í–‰

```bash
# manage.pyì™€ ë™ì¼í•œ ê²½ë¡œì—ì„œ ëª…ë ¹ì–´ ì§„í–‰
$ python manage.py runserver
```

### ì„œë²„ í™•ì¸

- [http://127.0.0.1:8000/](http://127.0.0.1:8000/) ì ‘ì† í›„ í™•ì¸

## Django í”„ë¡œì íŠ¸ì™€ ì•±

### Django Project

- ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ì§‘í•©
- DB ì„¤ì •, URL ì—°ê²°, ì „ì²´ ì•± ì„¤ì • ë“±ì„ ì²˜ë¦¬

### Django application

- ë…ë¦½ì ìœ¼ë¡œ ì‘ë™í•˜ëŠ” ê¸°ëŠ¥ ë‹¨ìœ„ ëª¨ë“ˆ
- ê°ì íŠ¹ì •í•œ ê¸°ëŠ¥ì„ ë‹´ë‹¹í•˜ë©° ë‹¤ë¥¸ ì•±ë“¤ê³¼ í•¨ê»˜ í•˜ë‚˜ì˜ í”„ë¡œì íŠ¸ë¥¼ êµ¬ì„±

![Untitled 1](https://github.com/yuj1818/TIL/assets/95585314/adf1975c-3cb2-436d-acb4-b514068fbc9e)

### ì•± ì‚¬ìš© ê³¼ì •

- ì•± ìƒì„±

```bash
# ì•±ì˜ ì´ë¦„ì€ ë³µìˆ˜í˜•ìœ¼ë¡œ ì§€ì •í•˜ëŠ” ê²ƒì„ ê¶Œì¥
$ python manage.py startapp articles
```

- ì•± ë“±ë¡

```python
# ë°˜ë“œì‹œ ì•±ì„ ìƒì„±í•œ í›„ì— ë“±ë¡í•´ì•¼ í•¨
# ë“±ë¡ í›„ ìƒì„±ì€ ë¶ˆê°€ëŠ¥

# settings.py
INSTALLED_APPS = [
	'articles',
	'django.contrib.admin',
	'django.contrib.auth',
	'dfango.contrib.contenttypes',
	'django.contrib.sessions',
	'django.contrib.messages',
	'django.contrib.staticfiles',
]
```

## Django ë””ìì¸ íŒ¨í„´

### ë””ìì¸ íŒ¨í„´

- ì†Œí”„íŠ¸ì›¨ì–´ ì„¤ê³„ì—ì„œ ë°œìƒí•˜ëŠ” ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•œ ì¼ë°˜ì ì¸ í•´ê²°ì±…
- ê³µí†µì ì¸ ë¬¸ì œë¥¼ í•´ê²°í•˜ëŠ”ë° ì“°ì´ëŠ” í˜•ì‹í™” ëœ ê´€í–‰

### MVC ë””ìì¸ íŒ¨í„´

- Model, View, Controller
- ì• í”Œë¦¬ì¼€ì´ì…˜ì„ êµ¬ì¡°í™”í•˜ëŠ” ëŒ€í‘œì ì¸ íŒ¨í„´
- ë°ì´í„°, ì‚¬ìš©ì ì¸í„°í˜ì´ìŠ¤, ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì„ ë¶„ë¦¬
- ì‹œê°ì  ìš”ì†Œì™€ ë’¤ì—ì„œ ì‹¤í–‰ë˜ëŠ” ë¡œì§ì„ ì„œë¡œ ì˜í–¥ ì—†ì´, ë…ë¦½ì ì´ê³  ì‰½ê²Œ ìœ ì§€ ë³´ìˆ˜í•  ìˆ˜ ìˆëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ë§Œë“¤ê¸° ìœ„í•´

### MTV ë””ìì¸ íŒ¨í„´

- Model, Template, View
- Djangoì—ì„œ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ êµ¬ì¡°í™”í•˜ëŠ” íŒ¨í„´
- ê¸°ì¡´ MVC íŒ¨í„´ê³¼ ë™ì¼í•˜ë‚˜ ëª…ì¹­ì„ ë‹¤ë¥´ê²Œ ì •ì˜í•œ ê²ƒ
    - View â†’ Template
    - Controller â†’ View

### í”„ë¡œì íŠ¸ êµ¬ì¡°

- setting.py
    - í”„ë¡œì íŠ¸ì˜ ëª¨ë“  ì„¤ì •ì„ ê´€ë¦¬
- urls.py
    - URLê³¼ ì´ì— í•´ë‹¹í•˜ëŠ” ì ì ˆí•œ viewsë¥¼ ì—°ê²°
- \__init\__.py
    - í•´ë‹¹ í´ë”ë¥¼ íŒ¨í‚¤ì§€ë¡œ ì¸ì‹í•˜ë„ë¡ ì„¤ì •
- asgi.py
    - ë¹„ë™ê¸°ì‹ ì›¹ ì„œë²„ì™€ì˜ ì—°ê²° ê´€ë ¨ ì„¤ì •
- wsgi.py
    - ì›¹ ì„œë²„ì™€ì˜ ì—°ê²° ê´€ë ¨ ì„¤ì •
- manage.py
    - Django í”„ë¡œì íŠ¸ì™€ ë‹¤ì–‘í•œ ë°©ë²•ìœ¼ë¡œ ìƒí˜¸ì‘ìš© í•˜ëŠ” ì»¤ë§¨ë“œë¼ì¸ ìœ í‹¸ë¦¬í‹°

### ì•± êµ¬ì¡°

- admin.py
    - ê´€ë¦¬ììš© í˜ì´ì§€ ì„¤ì •
- models.py
    - DBì™€ ê´€ë ¨ëœ Modelì„ ì •ì˜
    - MTV íŒ¨í„´ì˜ M
- views.py
    - HTTP ìš”ì²­ì„ ì²˜ë¦¬í•˜ê³  í•´ë‹¹ ìš”ì²­ì— ëŒ€í•œ ì‘ë‹µì„ ë°˜í™˜
    - url, mode, templateê³¼ ì—°ê³„
    - MTV íŒ¨í„´ì˜ V
- apps.py
    - ì•±ì˜ ì •ë³´ê°€ ì‘ì„±ëœ ê³³
- tests.py
    - í”„ë¡œì íŠ¸ í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ ì‘ì„±í•˜ëŠ” ê³³

## ìš”ì²­ê³¼ ì‘ë‹µ

### Djangoì™€ ìš”ì²­&ì‘ë‹µ

![Untitled 2](https://github.com/yuj1818/TIL/assets/95585314/8736c679-02dc-4032-ad6d-94f82a4e1aba)

### URLs

```python

# urls.py

from django.contrib import admin
from django.urls import path
from articles import views

urlpatterns = [
		path('admin/', admin.site.urls),
		path('articles/', views.index),
]
```

- [http://127.0.0.1:8000/articles/](http://127.0.0.1:8000/articles/) ë¡œ ìš”ì²­ì´ ì™”ì„ ë•Œ, views ëª¨ë“ˆì˜ index ë·° í•¨ìˆ˜ë¥¼ í˜¸ì¶œ

### View

```python
# views.py

from Django.shortcuts import render

def index(request):
		return render(request, 'articles/index.html')
```

- íŠ¹ì • ê²½ë¡œì— ìˆëŠ” templateê³¼ request ê°ì²´ë¥¼ ê²°í•©í•´ ì‘ë‹µ ê°ì²´ë¥¼ ë°˜í™˜í•˜ëŠ” index view í•¨ìˆ˜ ì •ì˜

### Template

- articles ì•± í´ë” ì•ˆì— templates í´ë” ìƒì„±
    - í´ë”ëª…ì€ ë°˜ë“œì‹œ templates ì—¬ì•¼ í•˜ë©° ê°œë°œìê°€ ì§ì ‘ ìƒì„±í•´ì•¼ í•¨
- templates í´ë” ì•ˆì— articles í´ë” ìƒì„±
- articles í´ë” ì•ˆì— í…œí”Œë¦¿ íŒŒì¼ ìƒì„±

### Djangoì—ì„œ templateì„ ì¸ì‹í•˜ëŠ” ê²½ë¡œ ê·œì¹™

- ì˜ˆì‹œ
    - **appí´ë” / templates /** articles / index.html
    - **appí´ë” / templates /** example.html
- DjangoëŠ” templates í´ë” ê¹Œì§€ ê¸°ë³¸ ê²½ë¡œë¡œ ì¸ì‹í•˜ê¸° ë•Œë¬¸ì— ì´ ì§€ì  ì´í›„ì˜ template ê²½ë¡œë¥¼ ì‘ì„±í•´ì•¼ í•¨

![Untitled 3](https://github.com/yuj1818/TIL/assets/95585314/f51f6a7f-2b4c-4c5f-b1b4-786e8d9cf8e3)

### ë°ì´í„° íë¦„ì— ë”°ë¥¸ ì½”ë“œ ì‘ì„±

- URLs â†’ View â†’ Template
    
    ![Untitled 4](https://github.com/yuj1818/TIL/assets/95585314/a788c6b4-79d3-4dd4-904d-8b4284031878)
    
## Django Template

ë°ì´í„° í‘œí˜„ì„ ì œì–´í•˜ë©´ì„œ, í‘œí˜„ê³¼ ê´€ë ¨ëœ ë¶€ë¶„ì„ ë‹´ë‹¹

### Django Template Language(DTL)

- Templateì—ì„œ ì¡°ê±´, ë°˜ë³µ, ë³€ìˆ˜ ë“±ì˜ í”„ë¡œê·¸ë˜ë°ì  ê¸°ëŠ¥ì„ ì œê³µí•˜ëŠ” ì‹œìŠ¤í…œ

### DTL Syntax

1. Variable
    - render í•¨ìˆ˜ì˜ ì„¸ë²ˆì§¸ ì¸ìë¡œ ë”•ì…”ë„ˆë¦¬ ë°ì´í„°ë¥¼ ì‚¬ìš©
    - ë”•ì…”ë„ˆë¦¬ keyì— í•´ë‹¹í•˜ëŠ” ë¬¸ìì—´ì´ templateì—ì„œ ì‚¬ìš©ê°€ëŠ¥í•œ ë³€ìˆ˜ëª…ì´ ë¨
    - dot(.)ì„ ì‚¬ìš©í•˜ì—¬ ë³€ìˆ˜ ì†ì„±ì— ì ‘ê·¼í•  ìˆ˜ ìˆìŒ
    
    ```html
    {{variable}}
    ```
    
2. Filters
    - í‘œì‹œí•  ë³€ìˆ˜ë¥¼ ìˆ˜ì •í•  ë•Œ ì‚¬ìš©
    - chainedê°€ ê°€ëŠ¥í•˜ë©° ì¼ë¶€ í•„í„°ëŠ” ì¸ìë¥¼ ë°›ê¸°ë„ í•¨
    - ì•½ 60ê°œì˜ built-in template filtersë¥¼ ì œê³µ
    
    ```html
    {{variable|filter}}
    ```
    
3. Tags
    - ë°˜ë³µ ë˜ëŠ” ë…¼ë¦¬ë¥¼ ìˆ˜í–‰í•˜ì—¬ ì œì–´ íë¦„ì„ ë§Œë“¦
    - ì¼ë¶€ íƒœê·¸ëŠ” ì‹œì‘ê³¼ ì¢…ë£Œ íƒœê·¸ê°€ í•„ìš”
    - ì•½ 24ê°œì˜ built-in template tagsë¥¼ ì œê³µ
    
    ```html
    {% tag %}
    ```
    
4. Comments
    - DTLì—ì„œì˜ ì£¼ì„
    
    ```html
    {# #}
    {% comment %}
    		{% if name == 'Sophia' %}
    		{% endif %}
    {% endcomment %}
    ```
    

### DTL ì˜ˆì‹œ

```python
# urls.py
from django.contrib import admin
from django.urls import path
from articles import views

urlpatterns = [
    path('admin/', admin.site.urls),
    path('articles/', views.index),
    path('dinner/', views.dinner)
]
```

```python
# views.py
def dinner(request):
    foods = ['êµ­ë°¥', 'êµ­ìˆ˜', 'ì¹´ë ˆ', 'íƒ•ìˆ˜ìœ¡']
    picked = random.choice(foods)
    context = {
        'foods': foods,
        'picked': picked
    }

    return render(request, 'articles/dinner.html', context)
```

```html
<!-- articles/dinner.html -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <p>{{ picked }} ë©”ë‰´ëŠ” {{ picked|length }}ê¸€ì ì…ë‹ˆë‹¤.</p>
    <h1>ë©”ë‰´íŒ</h1>
    <ul>
        {% for food in foods %}
            <li>{{ food }}</li>
        {% endfor %}
    </ul>
    {% if foods|length == 0 %}
        <p>ë©”ë‰´ê°€ ì†Œì§„ ë˜ì—ˆìŠµë‹ˆë‹¤.</p>
    {% else %}
        <p>ì•„ì§ ë©”ë‰´ê°€ ë‚¨ì•˜ìŠµë‹ˆë‹¤.</p>
    {% endif %}
</body>
</html>
```

## í…œí”Œë¦¿ ìƒì†

### ê¸°ë³¸ í…œí”Œë¦¿ êµ¬ì¡°ì˜ í•œê³„

- ë§Œì•½ ëª¨ë“  í…œí”Œë¦¿ì— bootstrapì„ ì ìš©í•˜ë ¤ë©´
- ëª¨ë“  í…œí”Œë¦¿ì— bootstrap CDNì„ ì‘ì„±í•´ì•¼ í• ê¹Œ?

### í…œí”Œë¦¿ ìƒì†(Template Inheritance)

- **í˜ì´ì§€ì˜ ê³µí†µìš”ì†Œë¥¼ í¬í•¨**í•˜ê³ , **í•˜ìœ„ í…œí”Œë¦¿ì´ ì¬ì •ì˜ í•  ìˆ˜ ìˆëŠ” ê³µê°„**ì„ ì •ì˜í•˜ëŠ” ê¸°ë³¸ â€˜skeletonâ€™ í…œí”Œë¦¿ì„ ì‘ì„±í•˜ì—¬ ìƒì† êµ¬ì¡°ë¥¼ êµ¬ì¶•

### ìƒì† êµ¬ì¡° êµ¬ì¶•

- skeleton ì—­í• ì˜ ìƒìœ„ í…œí”Œë¦¿ ì‘ì„±

```html
<!-- articles/base.html -->
<!DOCTYPE html>
<html lang="en">
<head>
		...
		{% comment %} bootstrap CDN ìƒëµ {% endcomment %}
</head>
<body>
		{% block content %}
		{% endblock content %}
		{% comment %} bootstrap CDN ìƒëµ {% endcomment %}
</body>
</html>
```

- ê¸°ì¡´ í•˜ìœ„ í…œí”Œë¦¿ì˜ ë³€í™”

```html
<!-- articles/index.html -->

{% extends 'articles/base.html' %}
{% block content %}
		<h1>Hello, {{ name }}</h1>
{% endblock content %}
```

```html
<!-- articles/dinner.html -->
{% extends "articles/base.html" %}
{% block content %}
    <p>{{ picked }} ë©”ë‰´ëŠ” {{ picked|length }}ê¸€ì ì…ë‹ˆë‹¤.</p>
    <h2>ë©”ë‰´íŒ</h2>
    <ul>
        {% for food in foods %}
            <li>{{ food }}</li>
        {% endfor %}
    </ul>
    {% if foods|length == 0 %}
        <p>ë©”ë‰´ê°€ ì†Œì§„ ë˜ì—ˆìŠµë‹ˆë‹¤.</p>
    {% else %}
        <p>ì•„ì§ ë©”ë‰´ê°€ ë‚¨ì•˜ìŠµë‹ˆë‹¤.</p>
    {% endif %}
{% endblock content %}
```

### â€˜extendsâ€™ tag

- ìì‹(í•˜ìœ„)í…œí”Œë¦¿ì´ ë¶€ëª¨ í…œí”Œë¦¿ì„ í™•ì¥í•œë‹¤ëŠ” ê²ƒì„ ì•Œë¦¼
- **ë°˜ë“œì‹œ í…œí”Œë¦¿ ìµœìƒë‹¨ì— ì‘ì„±ë˜ì–´ì•¼ í•¨(2ê°œ ì´ìƒ ì‚¬ìš© ë¶ˆê°€)**

### â€˜blockâ€™ tag

- í•˜ìœ„ í…œí”Œë¦¿ì—ì„œ ì¬ì •ì˜ í•  ìˆ˜ ìˆëŠ” ë¸”ë¡ì„ ì •ì˜
- í•˜ìœ„ í…œí”Œë¦¿ì´ ì‘ì„±í•  ìˆ˜ ìˆëŠ” ê³µê°„ì„ ì§€ì •

## HTML form(ìš”ì²­ê³¼ ì‘ë‹µ)

### ë°ì´í„°ë¥¼ ë³´ë‚´ê³  ê°€ì ¸ì˜¤ê¸°(Sending and Retrieving form data)

- HTML form elementë¥¼ í†µí•´ ì‚¬ìš©ìì™€ ì• í”Œë¦¬ì¼€ì´ì…˜ ê°„ì˜ ìƒí˜¸ì‘ìš© ì´í•´í•˜ê¸°
- HTML formì€ HTTP ìš”ì²­ì„ ì„œë²„ì— ë³´ë‚´ëŠ” ê°€ì¥ í¸ë¦¬í•œ ë°©ë²•

### â€˜formâ€™ element

- ì‚¬ìš©ìë¡œë¶€í„° í• ë‹¹ëœ ë°ì´í„°ë¥¼ ì„œë²„ë¡œ ì „ì†¡
- ì›¹ì—ì„œ ì‚¬ìš©ì ì •ë³´ë¥¼ ì…ë ¥í•˜ëŠ” ì—¬ëŸ¬ ë°©ì‹(text, password, checkbox ë“±)ì„ ì œê³µ

### fake Naver ì‹¤ìŠµ

```python
# urls.py

from django.contrib import admin
from django.urls import path
from articles import views

urlpatterns = [
    path('admin/', admin.site.urls),
    path('articles/', views.index),
    path('dinner/', views.dinner),
    path('search/', views.search)
]
```

```python
# views.py

from django.shortcuts import render

def search(request):
    return render(request, 'articles/search.html')
```

```html
<!-- articles/search.html -->
{% extends "articles/base.html" %}
{% block content %}
    <form action="https://search.naver.com/search.naver/" method="GET">
        <label for="message">ê²€ìƒ‰ì–´</label>
        <input type="text" name="query" id="message">
        <input type="submit" value="submit">
    </form>
{% endblock content %}
```

### â€˜actionâ€™ & â€˜methodâ€™

- formì˜ í•µì‹¬ ì†ì„± 2ê°€ì§€
- ë°ì´í„°ë¥¼ ì–´ë””(action)ë¡œ ì–´ë–¤ ë°©ì‹(method)ìœ¼ë¡œ ìš”ì²­í• ì§€

#### action

- ì…ë ¥ ë°ì´í„°ê°€ ì „ì†¡ë  URLì„ ì§€ì •(ëª©ì ì§€)
- ë§Œì•½ ì´ ì†ì„±ì„ ì§€ì •í•˜ì§€ ì•Šìœ¼ë©´ ë°ì´í„°ëŠ” í˜„ì¬ formì´ ìˆëŠ” í˜ì´ì§€ì˜ URLë¡œ ë³´ë‚´ì§

#### method

- ë°ì´í„°ë¥¼ ì–´ë–¤ ë°©ì‹ìœ¼ë¡œ ë³´ë‚¼ ê²ƒì¸ì§€ ì •ì˜
- ë°ì´í„°ì˜ HTTP request methods (GET, POST)ë¥¼ ì§€ì •

### â€˜inputâ€™ element

- ì‚¬ìš©ìì˜ ë°ì´í„°ë¥¼ ì…ë ¥ ë°›ì„ ìˆ˜ ìˆëŠ” ìš”ì†Œ
- type ì†ì„± ê°’ì— ë”°ë¼ ë‹¤ì–‘í•œ ìœ í˜•ì˜ ì…ë ¥ ë°ì´í„°ë¥¼ ë°›ìŒ

### â€˜nameâ€™ attribute

- inputì˜ í•µì‹¬ ì†ì„±
- ì…ë ¥í•œ ë°ì´í„°ì— ë¶™ì´ëŠ” ì´ë¦„(key)
- ë°ì´í„°ë¥¼ ì œì¶œí–ˆì„ ë•Œ ì„œë²„ëŠ” name ì†ì„±ì— ì„¤ì •ëœ ê°’ì„ í†µí•´ì„œë§Œ ì‚¬ìš©ìê°€ ì…ë ¥í•œ ë°ì´í„°ì— ì ‘ê·¼í•  ìˆ˜ ìˆìŒ

### Query String Parameters

- ì‚¬ìš©ìì˜ ì…ë ¥ ë°ì´í„°ë¥¼ URL ì£¼ì†Œì— íŒŒë¼ë¯¸í„¸ã„¹ í†µí•´ ì„œë²„ë¡œ ë³´ë‚´ëŠ” ë°©ë²•
- ë¬¸ìì—´ì€ ì•°í¼ìƒŒë“œ(&)ë¡œ ì—°ê²°ëœ key=value ìŒìœ¼ë¡œ êµ¬ì„±ë˜ë©°, ê¸°ë³¸ URLê³¼ ë¬¼ìŒí‘œ(?)ë¡œ êµ¬ë¶„ë¨
- ì˜ˆì‹œ
    - http://host:port/path?key=value&key=value

## form í™œìš©

### ì‚¬ìš©ì ì…ë ¥ ë°ì´í„°ë¥¼ ë°›ì•„ ê·¸ëŒ€ë¡œ ì¶œë ¥í•˜ëŠ” ì„œë²„ ë§Œë“¤ê¸°

```python
# urls.py
from django.contrib import admin
from django.urls import path
from articles import views

urlpatterns = [
    path('throw/', views.throw),
    path('catch/', views.catch)
]
```

```python
# views.py
from django.shortcuts import render

def throw(request):
    return render(request, 'articles/throw.html')

def catch(request):
    msg = request.GET.get('message')
    context = {
        'msg': msg
    }
    return render(request, 'articles/catch.html', context)
```

```html
<!-- throw.html -->
{% extends "articles/base.html" %}
{% block content %}
    <h1>Throw</h1>
    <form action="/catch/" method="GET">
        <input type="text" id="message" name="message">
        <input type="submit">
    </form>
{% endblock content %}
```

```html
<!-- catch.html -->
{% extends "articles/base.html" %}
{% block content %}
    <h1>Catch</h1>
    <h3>{{ msg }}ë¥¼ ë°›ì•˜ìŠµë‹ˆë‹¤!</h3>
{% endblock content %}
```

### HTTP request ê°ì²´

- formìœ¼ë¡œ ì „ì†¡í•œ ë°ì´í„°ë¿ë§Œ ì•„ë‹ˆë¼ ëª¨ë“  ìš”ì²­ ê´€ë ¨ ë°ì´í„°ê°€ ë‹´ê²¨ ìˆìŒ
- view í•¨ìˆ˜ì˜ ì²«ë²ˆì§¸ ì¸ì
- form ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ëŠ” ë°©ë²•
    
    ```python
    request.GET.get(ë°ì´í„° name)
    ```
    

## Django URLs

### ìš”ì²­ê³¼ ì‘ë‹µì—ì„œ Django URLsì˜ ì—­í• 

![Untitled 6](https://github.com/yuj1818/TIL/assets/95585314/68206ff4-dc1e-4af8-ba32-08618a38c77d)

### URL dispatcher

- ìš´í•­ ê´€ë¦¬ì, ë¶„ë°°ê¸°
- URL íŒ¨í„´ì„ ì •ì˜í•˜ê³  í•´ë‹¹ íŒ¨í„´ì´ ì¼ì¹˜í•˜ëŠ” ìš”ì²­ì„ ì²˜ë¦¬í•  view í•¨ìˆ˜ë¥¼ ì—°ê²°(ë§¤í•‘)

## ë³€ìˆ˜ì™€ URL

### í˜„ì¬ URL ê´€ë¦¬ì˜ ë¬¸ì œì 

- í…œí”Œë¦¿ì˜ ë§ì€ ë¶€ë¶„ì´ ì¤‘ë³µë˜ê³ , URLì˜ ì¼ë¶€ë§Œ ë³€ê²½ë˜ëŠ” ìƒí™©ì´ë¼ë©´ ê³„ì†í•´ì„œ ë¹„ìŠ·í•œ URLê³¼ í…œí”Œë¦¿ì„ ì‘ì„±í•´ ë‚˜ê°€ì•¼ í• ê¹Œ?

### Variable Routing

- URL ì¼ë¶€ì— ë³€ìˆ˜ë¥¼ í¬í•¨ì‹œí‚¤ëŠ” ê²ƒ
- ë³€ìˆ˜ëŠ” view í•¨ìˆ˜ì˜ ì¸ìë¡œ ì „ë‹¬í•  ìˆ˜ ìˆìŒ

#### Variable routing ì‘ì„±ë²•

- <`path_converter` : variable_name>

```python
path('articles/<int:num>/', views.detail),
path('hello/<str:name>/', views.greeting)
```

`path converters` : URL ë³€ìˆ˜ì˜ íƒ€ì…ì„ ì§€ì •(str, int ë“± 5ê°€ì§€ íƒ€ì… ì§€ì›)

#### Varibale routing ì‹¤ìŠµ

```python
# urls.py
from django.contrib import admin
from django.urls import path
from articles import views

urlpatterns = [
    path('hello/<str:name>/', views.greeting)
]
```

```python
# views.py
from django.shortcuts import render

def greeting(request, name):
    context = {
        'name': name
    }
    return render(request, 'articles/greeting.html', context)
```

```html
<!-- articles/greetings.html -->
{% extends "base.html" %}
{% block content %}
    <h1>Greeting</h1>
    <h3>{{ name }}ë‹˜ ì•ˆë…•í•˜ì„¸ìš”!</h3>
{% endblock content %}
```

## APPê³¼ URL

### App URL mapping

- ê° ì•±ì— URLì„ ì •ì˜í•˜ëŠ” ê²ƒ
- í”„ë¡œì íŠ¸ì™€ ê° ì•±ì´ URLì„ ë‚˜ëˆ„ì–´ ê´€ë¦¬ë¥¼ í¸í•˜ê²Œ í•˜ê¸° ìœ„í•¨

### 2ë²ˆì§¸ ì•± ìƒì„± í›„ ë°œìƒí•  ìˆ˜ ìˆëŠ” ë¬¸ì œ

- view í•¨ìˆ˜ ì´ë¦„ì´ ê°™ê±°ë‚˜ ê°™ì€ íŒ¨í„´ì˜ urlì£¼ì†Œë¥¼ ì‚¬ìš©í•˜ê²Œ ë˜ëŠ” ê²½ìš°
- ì•„ë˜ ì½”ë“œì™€ ê°™ì´ í•´ê²°í•  ìˆ˜ ì‡ìœ¼ë‚˜ ë” ì¢‹ì€ ë°©ë²•ì´ í•„ìš”
- **URLì„ ê°ì appì—ì„œ ê´€ë¦¬í•˜ì**

#### ê¸°ì¡´ URL êµ¬ì¡°

![Untitled 6](https://github.com/yuj1818/TIL/assets/95585314/68206ff4-dc1e-4af8-ba32-08618a38c77d)

#### ë³€ê²½ëœ URL êµ¬ì¡°

![Untitled 7](https://github.com/yuj1818/TIL/assets/95585314/65fe9f40-f3da-435f-b3b0-cb82e39a3682)

### url êµ¬ì¡° ë³€í™”

```python
# firstpjt/urls.py
from django.contrib import admin
from django.urls import path, include
from articles import views

urlpatterns = [
    path('admin/', admin.site.urls),
    path('articles/', include('articles.urls')),
    path('pages/', include('pages.urls'))
]
```

```python
# articles/urls.py
from django.urls import path
from . import views

urlpatterns = [
    path('index/', views.index),
    path('articles/', views.index),
    path('dinner/', views.dinner),
    path('search/', views.search),
    path('throw/', views.throw),
    path('catch/', views.catch),
    path('hello/<str:name>/', views.greeting)
]
```

```python
# pages/urls.py
from django.urls import path
from . import views

urlpatterns = [
    path('index/', views.index)
]
```

### include()

- í”„ë¡œì íŠ¸ ë‚´ë¶€ ì•±ë“¤ì„ URLì„ ì°¸ì¡°í•  ìˆ˜ ìˆë„ë¡ ë§¤í•‘í•˜ëŠ” í•¨ìˆ˜
- URLì˜ ì¼ì¹˜í•˜ëŠ” ë¶€ë¶„ê¹Œì§€ ì˜ë¼ë‚´ê³ , ë‚¨ì€ ë¬¸ìì—´ ë¶€ë¶„ì€ í›„ì† ì²˜ë¦¬ë¥¼ ìœ„í•´ includeëœ URLë¡œ ì „ë‹¬

## URL ì´ë¦„ ì§€ì •

### url êµ¬ì¡° ë³€ê²½ì— ë”°ë¥¸ ë¬¸ì œì 

- ê¸°ì¡´ â€˜articles/â€™ì£¼ì†Œê°€ â€˜articles/index/â€™ë¡œ ë³€ê²½ë¨ì— ë”°ë¼ í•´ë‹¹ ì£¼ì†Œë¥¼ ì‚¬ìš©í•˜ëŠ” ëª¨ë“  ìœ„ì¹˜ë¥¼ ì°¾ì•„ê°€ ë³€ê²½í•´ì•¼ í•¨
- **URLì— ì´ë¦„ì„ ì§€ì–´ì£¼ë©´ ì´ë¦„ë§Œ ê¸°ì–µí•˜ë©´ ë˜ì§€ ì•Šì„ê¹Œ?**

### Naming URL patterns

- URLì— ì´ë¦„ì„ ì§€ì •í•˜ëŠ” ê²ƒ
- path í•¨ìˆ˜ì˜ name ì¸ìë¥¼ ì •ì˜í•´ì„œ ì‚¬ìš©

```python
# articles/urls.py
from django.urls import path
from . import views

urlpatterns = [
    path('index/', views.index, name='index'),
    path('articles/', views.index, name='articles'),
    path('dinner/', views.dinner, name='dinner'),
    path('search/', views.search, name='search'),
    path('throw/', views.throw, name='throw'),
    path('catch/', views.catch, name='catch'),
    path('hello/<str:name>/', views.greeting, name='greeting')
]
```

```html
<!-- articles/index.html -->
{% extends "base.html" %}
{% block content %}
  <h1>ì•ˆë…•! {{name}}</h1>
  <a href="{% url 'dinner' %}">dinner</a>
  <a href="{% url 'search' %}">search</a>
  <a href="{% url 'throw' %}">throw</a>
{% endblock content %}
```

![Untitled 8](https://github.com/yuj1818/TIL/assets/95585314/6b8f3ecf-344c-43bc-9786-4b9a277024f5)

### â€˜urlâ€™ tag

```html
{% url 'url-name' arg1 arg2 %}
```

- ì£¼ì–´ì§„ URL íŒ¨í„´ì˜ ì´ë¦„ê³¼ ì¼ì¹˜í•˜ëŠ” ì ˆëŒ€ ê²½ë¡œ ì£¼ì†Œë¥¼ ë°˜í™˜

## URL ì´ë¦„ ê³µê°„

### URL ì´ë¦„ ì§€ì • í›„ ë‚¨ì€ ë¬¸ì œ

- articles ì•±ì˜ url ì´ë¦„ê³¼ pages ì•±ì˜ url ì´ë¦„ì´ ê°™ì€ ìƒí™©
- ë‹¨ìˆœíˆ ì´ë¦„ë§Œìœ¼ë¡œëŠ” ì™„ë²½í•˜ê²Œ ë¶„ë¦¬í•  ìˆ˜ ì—†ìŒ
- **ì´ë¦„ì— ì„±(í‚¤, key)ë¥¼ ë¶™ì´ì**

### â€˜app_nameâ€™ ì†ì„± ì§€ì •

```python
# articles/urls.py
from django.urls import path
from . import views

app_name = 'articles'

urlpatterns = [
    ...,
]
```

```python
# pages/urls.py
from django.urls import path
from . import views

app_name = 'pages'

urlpatterns = [
    ...,
]
```

### URL tagì˜ ìµœì¢… ë³€í™”

{% url â€˜indexâ€™ %} â‡’ {% url â€˜articles:indexâ€™ %}

## Django Model

- DBì˜ í…Œì´ë¸”ì„ ì •ì˜í•˜ê³  ì¡°ì‘í•  ìˆ˜ ìˆëŠ” ê¸°ëŠ¥ë“¤ì„ ì œê³µ
- í…Œì´ë¸” êµ¬ì¡°ë¥¼ ì„¤ê³„í•˜ëŠ” ì²­ì‚¬ì§„(blueprint)

### model í´ë˜ìŠ¤ ì‘ì„±

```python

# articles/models.py

class Article(models.Model):
		title = models.CharField(max_length=10)
		content = models.TextField()
```

- ìœ„ì˜ ëª¨ë¸ í´ë˜ìŠ¤ëŠ” ìµœì¢…ì ìœ¼ë¡œ DBì— ë‹¤ìŒê³¼ ê°™ì€ í…Œì´ë¸” êµ¬ì¡°ë¥¼ ë§Œë“¦

![ëª¨ë¸ í´ë˜ìŠ¤ == í…Œì´ë¸” ì„¤ê³„ë„](https://github.com/yuj1818/TIL/assets/95585314/37ab9bdd-e385-4f1a-98ed-cd526abf67ac)

ëª¨ë¸ í´ë˜ìŠ¤ == í…Œì´ë¸” ì„¤ê³„ë„

- django.db.models ëª¨ë“ˆì˜ Modelì´ë¼ëŠ” ë¶€ëª¨ í´ë˜ìŠ¤ë¥¼ ìƒì† ë°›ìŒ
- Modelì€ modelì— ê´€ë ¨ëœ ëª¨ë“  ì½”ë“œê°€ ì´ë¯¸ ì‘ì„±ë˜ì–´ìˆëŠ” í´ë˜ìŠ¤
    - [https://github.com/django/django/blob/main/django/db/models/base.py#L459](https://github.com/django/django/blob/main/django/db/models/base.py#L459)
- ê°œë°œìëŠ” ê°€ì¥ ì¤‘ìš”í•œ í…Œì´ë¸” êµ¬ì¡°ë¥¼ ì–´ë–»ê²Œ ì„¤ê³„í• ì§€ì— ëŒ€í•œ ì½”ë“œë§Œ ì‘ì„±í•˜ë„ë¡ í•˜ê¸° ìœ„í•œ ê²ƒ(í”„ë ˆì„ì›Œí¬ì˜ ì´ì )
- í´ë˜ìŠ¤ ë³€ìˆ˜ëª…
    - í…Œì´ë¸”ì˜ ê° â€œí•„ë“œ(ì—´) ì´ë¦„â€
    - title, content
- model Field í´ë˜ìŠ¤
    - í…Œì´ë¸” í•„ë“œì˜ â€œë°ì´í„° íƒ€ì…â€
    - CharField, TextField
    - [https://docs.djangoproject.com/en/4.2/ref/models/fileds/](https://docs.djangoproject.com/en/4.2/ref/models/fileds/)
- model Field í´ë˜ìŠ¤ì˜ í‚¤ì›Œë“œ ì¸ì
    - í…Œì´ë¸” í•„ë“œì˜ `ì œì•½ì¡°ê±´` ê´€ë ¨ ì„¤ì •
    - [https://docs.djangoproject.com/en/4.2/ref/models/fields/#field-options](https://docs.djangoproject.com/en/4.2/ref/models/fields/#field-options)
    - `ì œì•½ì¡°ê±´` : ë°ì´í„°ê°€ ì˜¬ë°”ë¥´ê²Œ ì €ì¥ë˜ê³  ê´€ë¦¬ë˜ë„ë¡ í•˜ê¸° ìœ„í•œ ê·œì¹™(ex: ìˆ«ìë§Œ, ë¬¸ì 100ì ê¹Œì§€ë§Œ ë“±)

## Migrations

model í´ë˜ìŠ¤ì˜ ë³€ê²½ì‚¬í•­(í•„ë“œ ìƒì„±, ìˆ˜ì • ì‚­ì œ ë“±)ì„ DBì— ìµœì¢… ë°˜ì˜í•˜ëŠ” ë°©ë²•

### â­Migrations ê³¼ì •â­

![Untitled 10](https://github.com/yuj1818/TIL/assets/95585314/00f13a75-ad10-4ba5-868d-acaad77f282e)

- model classë¥¼ ê¸°ë°˜ìœ¼ë¡œ ìµœì¢… ì„¤ê³„ë„(migration) ì‘ì„±

```bash
$ python manage.py makemigrations
```

- ìµœì¢… ì„¤ê³„ë„ë¥¼ DBì— ì „ë‹¬í•˜ì—¬ ë°˜ì˜

```bash
$ python manage.py migrate
```

### migrate í›„ DB ë‚´ì— ìƒì„± ëœ í…Œì´ë¸” í™•ì¸

- Article ëª¨ë¸ í´ë˜ìŠ¤ë¡œ ë§Œë“¤ì–´ì§„ articles_article í…Œì´ë¸”

![Untitled 11](https://github.com/yuj1818/TIL/assets/95585314/49bdbc8c-3404-4619-8b73-2a5929101d99)

### ì¶”ê°€ Migrations

#### ì¶”ê°€ ëª¨ë¸ í•„ë“œ ì‘ì„±

```python
# articles/models.py

class Articles(models.Model):
		title = models.CharField(max_length=10)
		content = models.TextField()
		created_at = models.DateTimeField(auto_now_add=True)
		updated_at = models.DateTimeField(auto_now=True)
```

- ì´ë¯¸ ê¸°ì¡´ í…Œì´ë¸”ì´ ì¡´ì¬í•˜ê¸° ë•Œë¬¸ì— í•„ë“œë¥¼ ì¶”ê°€í•  ë•Œ í•„ë“œì˜ ê¸°ë³¸ ê°’ ì„¤ì •ì´ í•„ìš”
- 1ë²ˆì€ í˜„ì¬ ëŒ€í™”ë¥¼ ìœ ì§€í•˜ë©´ì„œ ì§ì ‘ ê¸°ë³¸ ê°’ì„ ì…ë ¥í•˜ëŠ” ë°©ë²•
- 2ë²ˆì€ í˜„ì¬ ëŒ€í™”ì—ì„œ ë‚˜ê°„ í›„ models.pyì— ê¸°ë³¸ ê°’ ê´€ë ¨ ì„¤ì •ì„ í•˜ëŠ” ë°©ë²•

```bash
$ python manage.py makemigrations
```

![Untitled 12](https://github.com/yuj1818/TIL/assets/95585314/3141d884-9ede-4ea5-8cd6-132b774cdb1e)

- ì¶”ê°€í•˜ëŠ” í•„ë“œì˜ ê¸°ë³¸ ê°’ì„ ì…ë ¥í•´ì•¼í•˜ëŠ” ìƒí™©
- ë‚ ì§œ ë°ì´í„°ì´ê¸° ë•Œë¬¸ì— ì§ì ‘ ì…ë ¥í•˜ê¸° ë³´ë‹¤ Djangoê°€ ì œì•ˆí•˜ëŠ” ê¸°ë³¸ ê°’ì„ ì‚¬ìš©í•˜ëŠ” ê²ƒì„ ê¶Œì¥
- ì•„ë¬´ê²ƒë„ ì…ë ¥í•˜ì§€ ì•Šê³  enterë¥¼ ëˆ„ë¥´ë©´ Djangoê°€ ì œì•ˆí•˜ëŠ” ê¸°ë³¸ ê°’ìœ¼ë¡œ ì„¤ì • ë¨

![Untitled 13](https://github.com/yuj1818/TIL/assets/95585314/73398fe7-d8c6-4f69-a71c-0780e29ec25b)

- migrations ê³¼ì • ì¢…ë£Œ í›„ 2ë²ˆì§¸ migration íŒŒì¼ì´ ìƒì„±ë¨ì„ í™•ì¸

![Untitled 14](https://github.com/yuj1818/TIL/assets/95585314/6409bf35-f76b-43db-9cac-fe5cda79cb1d)

- ì´ì²˜ëŸ¼ DjangoëŠ” ì„¤ê³„ë„ë¥¼ ìŒ“ì•„ê°€ë©´ì„œ ì¶”í›„ ë¬¸ì œê°€ ìƒê²¼ì„ ì‹œ ë³µêµ¬í•˜ê±°ë‚˜ ë˜ëŒë¦´ ìˆ˜ ìˆë„ë¡ í•¨(â‰’ git commit)
- migrate í›„ í…Œì´ë¸” í•„ë“œ ë³€í™” í™•ì¸

```bash
$ python manage.py migrate
```

![Untitled 15](https://github.com/yuj1818/TIL/assets/95585314/8225fb7a-ad68-49e6-91ef-0a37e0c2c680)

- **model classì— ë³€ê²½ì‚¬í•­ì´ ìƒê²¼ë‹¤ë©´, ë°˜ë“œì‹œ ìƒˆë¡œìš´ ì„¤ê³„ë„ë¥¼ ìƒì„±í•˜ê³ , ì´ë¥¼ DBì— ë°˜ì˜í•´ì•¼ í•¨**
    - model class ë³€ê²½ â†’ makemigrations â†’ migrate

### Model Field

- DB í…Œì´ë¸”ì˜ í•„ë“œ(ì—´)ì„ ì •ì˜í•˜ë©°, í•´ë‹¹ í•„ë“œì—ì„œ ì €ì¥ë˜ëŠ” ë°ì´í„° íƒ€ì…ê³¼ ì œì•½ì¡°ê±´ì„ ì •ì˜

#### CharField()

- ê¸¸ì´ì˜ ì œí•œì´ ìˆëŠ” ë¬¸ìì—´ì„ ë„£ì„ ë•Œ ì‚¬ìš©
- í•„ë“œì˜ ìµœëŒ€ ê¸¸ì´ë¥¼ ê²°ì •í•˜ëŠ” max_lengthëŠ” í•„ìˆ˜ ì¸ì

#### TextField()

- ê¸€ìì˜ ìˆ˜ê°€ ë§ì„ ë•Œ ì‚¬ìš©

#### DateTimeField()

- ë‚ ì§œì™€ ì‹œê°„ì„ ë„£ì„ ë•Œ ì‚¬ìš©
- ğŸ“’DateTimeFieldì˜ ì„ íƒ ì¸ì
    - auto_now
        - ë°ì´í„°ê°€ ì €ì¥ë  ë•Œë§ˆë‹¤ ìë™ìœ¼ë¡œ í˜„ì¬ ë‚ ì§œì‹œê°„ì„ ì €ì¥
    - auto_now_add
        - ë°ì´í„°ê°€ ì²˜ìŒ ìƒì„±ë  ë•Œë§Œ ìë™ìœ¼ë¡œ í˜„ì¬ ë‚ ì§œì‹œê°„ì„ ì €ì¥

## Admin site

### Automatic admin interface

- DjangoëŠ” ì¶”ê°€ ì„¤ì¹˜ ë° ì„¤ì • ì—†ì´ ìë™ìœ¼ë¡œ ê´€ë¦¬ì ì¸í„°í˜ì´ìŠ¤ë¥¼ ì œê³µ
- ë°ì´í„° í™•ì¸ ë° í…ŒìŠ¤íŠ¸ ë“±ì„ ì§„í–‰í•˜ëŠ”ë° ë§¤ìš° ìœ ìš©

### admin ê³„ì • ìƒì„±

- emailì€ ì„ íƒì‚¬í•­ì´ê¸° ë•Œë¬¸ì— ì…ë ¥í•˜ì§€ ì•Šê³  ì§„í–‰ ê°€ëŠ¥
- ë¹„ë°€ë²ˆí˜¸ ì…ë ¥ ì‹œ ë³´ì•ˆìƒ í„°ë¯¸ë„ì— ì¶œë ¥ë˜ì§€ ì•Šìœ¼ë‹ˆ ë¬´ì‹œí•˜ê³  ì…ë ¥ ì´ì–´ê°€ê¸°

```bash
$ python manage.py createsuperuser
```

### adminì— ëª¨ë¸ í´ë˜ìŠ¤ ë“±ë¡

- admin.pyì— ì‘ì„±í•œ ëª¨ë¸ í´ë˜ìŠ¤ë¥¼ ë“±ë¡í•´ì•¼ë§Œ admin siteì—ì„œ í™•ì¸ ê°€ëŠ¥

```python
from django.contrib import admin
from .models import Article

admin.site.register(Article)
```

## ORM(Object-Relational-Mapping)

ê°ì²´ ì§€í–¥ í”„ë¡œê·¸ë˜ë° ì–¸ì–´ë¥¼ ì‚¬ìš©í•˜ì—¬ í˜¸í™˜ë˜ì§€ ì•ŠëŠ” ìœ í˜•ì˜ ì‹œìŠ¤í…œ ê°„ì— ë°ì´í„°ë¥¼ ë³€í™˜í•˜ëŠ” ê¸°ìˆ 

### ORMì˜ ì—­í• 

- django(Python Object)ì™€ DB(SQL)ëŠ” ì„œë¡œ ë‹¤ë¥¸ ì–¸ì–´ë¥¼ ì‚¬ìš©í•˜ê¸° ë•Œë¬¸ì— ì†Œí†µì´ ë¶ˆê°€
- ORMì´ djangoì™€ DBì˜ ì¤‘ê°„ì—ì„œ ì†Œí†µì„ ê°€ëŠ¥í•˜ê²Œ í•¨

### QuerySet API

- ORMì—ì„œ ë°ì´í„°ë¥¼ ê²€ìƒ‰, í•„í„°ë§, ì •ë ¬ ë° ê·¸ë£¹í™” í•˜ëŠ”ë° ì‚¬ìš©í•˜ëŠ” ë„êµ¬
- APIë¥¼ ì‚¬ìš©í•˜ì—¬ SQLì´ ì•„ë‹Œ Python ì½”ë“œë¡œ ë°ì´í„°ë¥¼ ì²˜ë¦¬
- Pythonì˜ ëª¨ë¸ í´ë˜ìŠ¤ì™€ ì¸ìŠ¤í„´ìŠ¤ë¥¼ í™œìš©í•´ DBì— ë°ì´í„°ë¥¼ ì €ì¥, ì¡°íšŒ, ìˆ˜ì •, ì‚­ì œí•˜ëŠ” ê²ƒ

<img src="https://github.com/yuj1818/TIL/assets/95585314/3c1eb412-a2de-421e-9866-46c06ac3ff16" width="50%">

#### QuerySet API êµ¬ë¬¸

- (Model class).(Manager).(Queryset API)â€™
- Managerê°€ methodë¥¼ ê°€ì§€ê³  ìˆìŒ
- ì˜ˆ) Article.objects.all()

#### Query

- ë°ì´í„°ë² ì´ìŠ¤ì— íŠ¹ì •í•œ ë°ì´í„°ë¥¼ ë³´ì—¬ ë‹¬ë¼ëŠ” ìš”ì²­
- ì¿¼ë¦¬ë¬¸ì„ ì‘ì„±í•œë‹¤ â‡’ ì›í•˜ëŠ” ë°ì´í„°ë¥¼ ì–»ê¸° ìœ„í•´ ë°ì´í„°ë² ì´ìŠ¤ì— ìš”ì²­ì„ ë³´ë‚¼ ì½”ë“œë¥¼ ì‘ì„±í•œë‹¤
- íŒŒì´ì¬ìœ¼ë¡œ ì‘ì„±í•œ ì½”ë“œê°€ ORMì— ì˜í•´ SQLë¡œ ë³€í™˜ë˜ì–´ ë°ì´í„°ë² ì´ìŠ¤ì— ì „ë‹¬ë˜ë©°, ë°ì´í„°ë² ì´ìŠ¤ì˜ ì‘ë‹µ ë°ì´í„°ë¥¼ ORMì´ QuerySetì´ë¼ëŠ” ìë£Œ í˜•íƒœë¡œ ë³€í™˜í•˜ì—¬ ìš°ë¦¬ì—ê²Œ ì „ë‹¬

#### QuerySet

- ë°ì´í„°ë² ì´ìŠ¤ì—ê²Œì„œ ì „ë‹¬ ë°›ì€ ê°ì²´ ëª©ë¡(ë°ì´í„° ëª¨ìŒ)
    - ìˆœíšŒê°€ ê°€ëŠ¥í•œ ë°ì´í„°ë¡œì¨ 1ê°œ ì´ìƒì˜ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì™€ ì‚¬ìš©í•  ìˆ˜ ìˆìŒ
- Django ORMì„ í†µí•´ ë§Œë“¤ì–´ì§„ ìë£Œí˜•
- ë‹¨, ë°ì´í„°ë² ì´ìŠ¤ê°€ ë‹¨ì¼í•œ ê°ì²´ë¥¼ ë°˜í™˜ í•  ë•ŒëŠ” QuerySetì´ ì•„ë‹Œ ëª¨ë¸(Class)ì˜ ì¸ìŠ¤í„´ìŠ¤ë¡œ ë°˜í™˜ë¨

### QuerySet API ì‹¤ìŠµ

#### QuerySet API ì‹¤ìŠµ ì‚¬ì „ ì¤€ë¹„

```bash
pip install ipython
pip install django-extensions
```

```python
# settings.py

INSTALLED_APPS = [
		# local applications
		'articles',
		# ì™¸ë¶€ ë¼ì´ë¸ŒëŸ¬ë¦¬
		'django_extensions',
		# ì¥ê³  ë‚´ë¶€
		...,
]
```

```bash
pip freeze > requirements.txt
```

#### Django shell

- Django í™˜ê²½ ì•ˆì—ì„œ ì‹¤í–‰ë˜ëŠ” python shell
- ì…ë ¥í•˜ëŠ” QuerySet API êµ¬ë¬¸ì´ Django í”„ë¡œì íŠ¸ì— ì˜í–¥ì„ ë¯¸ì¹¨

```bash
# Django shell ì‹¤í–‰
python manage.py shell_plus
```

#### Create

```bash
# ë°©ë²• 1
article = Article() # Article(class)ë¡œë¶€í„° article(instance) ìƒì„±
article.title = 'first' # ì¸ìŠ¤í„´ìŠ¤ ë³€ìˆ˜(title)ì— ê°’ì„ í• ë‹¹
article.content = 'django!' # ì¸ìŠ¤í„´ìŠ¤ ë³€ìˆ˜(content)ì— ê°’ì„ í• ë‹¹
article.save() # saveë¥¼ í•˜ì§€ ì•Šìœ¼ë©´ ì•„ì§ DBì— ê°’ì´ ì €ì¥ë˜ì§€ ì•ŠìŒ
```

```bash
# ë°©ë²• 2
article = Article(title='second', content='django!')
article.save()
```

```bash
# ë°©ë²• 3
Article.objects.create(title='third', content='django!')
```

`save()` : ê°ì²´ë¥¼ ë°ì´í„°ë² ì´ìŠ¤ì— ì €ì¥í•˜ëŠ” ë©”ì„œë“œ

#### Read

```bash
Article.objects.all()
```

`all()` : ì „ì²´ ë°ì´í„° ì¡°íšŒ

```bash
Article.objects.get(pk=1) # 1ë²ˆì§¸ ë°ì´í„° ì¡°íšŒ
Article.objects.get(pk=100) # 100ë²ˆì§¸ ë°ì´í„° ì¡°íšŒ
Article.objects.get(content='django!')
# content í•„ë“œ ê°’ì´ django!ì¸ ë°ì´í„°ê°€ ì—¬ëŸ¬ ê°œì´ë¯€ë¡œ ì—ëŸ¬ê°€ ì¼ì–´ë‚¨.
# get()ì€ ê°ì²´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìœ¼ë©´ DoesNotExist ì˜ˆì™¸ë¥¼ ë°œìƒì‹œí‚¤ê³ , ë‘˜ ì´ìƒì˜ ê°ì²´ë¥¼ ì°¾ìœ¼ë©´ MultipleObjectsReturned ì˜ˆì™¸ë¥¼ ë°œìƒì‹œí‚´
# ìœ„ì™€ ê°™ì€ íŠ¹ì§•ì„ ê°€ì§€ê³  ìˆê¸° ë•Œë¬¸ì— primary keyì™€ ê°™ì´ ê³ ìœ ì„±(uniqueness)ì„ ë³´ì¥í•˜ëŠ” ì¡°íšŒì—ì„œ ì‚¬ìš©í•´ì•¼ í•¨
```

`get()` : ë‹¨ì¼ ë°ì´í„° ì¡°íšŒ

```bash
Article.objects.filter(content='django!') # content í•„ë“œ ê°’ì´ django!ì¸ ë°ì´í„° ë‹¤ ì¡°íšŒ
Article.objects.filter(title='abc') # title í•„ë“œ ê°’ì´ abcì´ ë°ì´í„° ë‹¤ ì¡°íšŒ
Article.objects.filter(title='first') # title í•„ë“œ ê°’ì´ firstì¸ ë°ì´í„° ë‹¤ ì¡°íšŒ
```

`filter()` : íŠ¹ì • ì¡°ê±´ ë°ì´í„° ì¡°íšŒ

#### Update

- ë°ì´í„° ìˆ˜ì •
- ì¸ìŠ¤í„´ìŠ¤ ë³€ìˆ˜ë¥¼ ë³€ê²½ í›„ save ë©”ì„œë“œ í˜¸ì¶œ

```bash
article = Artile.objects.get(pk=1) # ìˆ˜ì •í•  ì¸ìŠ¤í„´ìŠ¤ ì¡°íšŒ
article.title = 'byebye' # ì¸ìŠ¤í„´ìŠ¤ ë³€ìˆ˜ ë³€ê²½
article.save() # ì €ì¥
```

#### Delete

- ë°ì´í„° ì‚­ì œ
- ì‚­ì œí•˜ë ¤ëŠ” ë°ì´í„° ì¡°íšŒ í›„ delete ë©”ì„œë“œ í˜¸ì¶œ

```bash
article = Article.objects.get(pk=1) # ì‚­ì œí•  ì¸ìŠ¤í„´ìŠ¤ ì¡°íšŒ
article.delete() # delete ë©”ì„œë“œ í˜¸ì¶œ
```

### ORM with view

#### Read

- ì „ì²´ ê²Œì‹œê¸€ ì¡°íšŒ

```python
# articles/views.py

from .models import Article

def index(request):
articles = Article.objects.all()
context = {
	'articles': articles,
}
return render(request, 'articles/index.html', context)
```

```html
<!-- articles/index.html -->

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>
<body>
  <h1>Articles</h1>
  <hr>
  {% for article in articles %}
    <p>ê¸€ë²ˆí˜¸: {{article.pk}}</p>
    <p>ê¸€ ì œëª©: {{article.title}}</p>
    <p>ê¸€ ë‚´ìš©: {{article.content}}</p>
    <hr>
  {% endfor %}
</body>
</html>
```

- ë‹¨ì¼ ê²Œì‹œê¸€ ì¡°íšŒ

```python
# articles/urls.py

from django.urls import path
from . import views

urlpatterns = [
    path('', views.index, name='index'),
    path('<int:pk>/', views.detail, name='detail'),
]
```

```python
# articles/views.py

def detail(request, pk):
    article = Article.objects.get(pk=pk)
    context = {
        'article': article,
    }
    return render(request, 'articles/detail.html', context)
```

```html
<!-- templates/articles/detail.html -->

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>
<body>
  <h2>DETAIL</h2>
  <h3>{{article.pk}} ë²ˆì§¸ ê¸€</h3>
  <hr>
  <p>ì œëª©: {{article.title}}</p>
  <p>ë‚´ìš©: {{article.content}}</p>
  <p>ì‘ì„± ì‹œê°: {{article.created_at}}</p>
  <p>ìˆ˜ì • ì‹œê°: {{article.updated_at}}</p>
  <hr>
  <a href="{% url "index" %}">[back]</a>
</body>
</html>
```

#### Create

```python
# articles/urls.py

from django.urls import path
from . import views

app_name = 'articles'

urlpatterns = [
    ...
    path('new/', views.new, name='new'),
    path('create/', views.create, name='create'),
]
```

```python
# articles/views.py

def new(request):
    return render(request, 'articles/new.html')

def create(request):
    title = request.GET.get('title')
    content = request.GET.get('content')

    article = Article(title=title, content=content)
    article.save()

    return render(request, 'articles/create.html')
```

```html
<!-- templates/articles/new.html -->

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>
<body>
  <h1>NEW</h1>
  <form action="">
    <div>
      <label for="title">Title: </label>
      <input type="text" id="title" name="title">
    </div>
    <div>
      <label for="content">Content: </label>
      <textarea name="content" id="content"></textarea>
    </div>
    <input type="submit" value="ì œì¶œ">
  </form>
  <hr>
  <a href="articles:index">[back]</a>
</body>
</html>
```

#### HTTP request methods

- HTTP
    - ë„¤íŠ¸ì›Œí¬ ìƒì—ì„œ ë°ì´í„°ë¥¼ ì£¼ê³  ë°›ê¸° ìœ„í•œ ì•½ì†
- HTTP request methods
    - ë°ì´í„°(ë¦¬ì†ŒìŠ¤)ì— ì–´ë–¤ ìš”ì²­(í–‰ë™)ì„ ì›í•˜ëŠ”ì§€ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ê²ƒ
    - GET
        - íŠ¹ì • ë¦¬ì†ŒìŠ¤ë¥¼ ì¡°íšŒí•˜ëŠ” ìš”ì²­
        - GETìœ¼ë¡œ ë°ì´í„°ë¥¼ ì „ë‹¬í•˜ë©´ Query string í˜•ì‹ìœ¼ë¡œ ë³´ë‚´ì§
    - POST
        - íŠ¹ì • ë¦¬ì†ŒìŠ¤ì— ë³€ê²½(ìƒì„±, ìˆ˜ì •, ì‚­ì œ)ì„ ìš”êµ¬í•˜ëŠ” ìš”ì²­
        - POSTë¡œ ë°ì´í„°ë¥¼ ì „ë‹¬í•˜ë©´ HTTP Bodyì— ë‹´ê²¨ ë³´ë‚´ì§
- HTTP response status code
    - íŠ¹ì • HTTP ìš”ì²­ì´ ì„±ê³µì ìœ¼ë¡œ ì™„ë£Œë˜ì—ˆëŠ”ì§€ë¥¼ 3ìë¦¬ ìˆ«ìë¡œ í‘œí˜„í•˜ê¸°ë¡œ ì•½ì†í•œ ê²ƒ
    - [https://developer.mozilla.org/en-US/docs/Web/HTTP/Status](https://developer.mozilla.org/en-US/docs/Web/HTTP/Status)
    - 403 Forbidden
        - ì„œë²„ì— ìš”ì²­ì´ ì „ë‹¬ë˜ì—ˆì§€ë§Œ, ê¶Œí•œ ë•Œë¬¸ì— ê±°ì ˆë˜ì—ˆë‹¤ëŠ” ê²ƒì„ ì˜ë¯¸
- CSRF(Cross-Site-Request-Forgery)
    - ì‚¬ì´íŠ¸ ê°„ ìš”ì²­ ìœ„ì¡°
    - ì‚¬ìš©ìê°€ ìì‹ ì˜ ì˜ì§€ì™€ ë¬´ê´€í•˜ê²Œ ê³µê²©ìê°€ ì˜ë„í•œ í–‰ë™ì„ í•˜ì—¬ ì›¹ í˜ì´ì§€ë¥¼ ë³´ì•ˆì— ì·¨ì•½í•˜ê²Œ í•˜ê±°ë‚˜ ìˆ˜ì •, ì‚­ì œ ë“±ì˜ ì‘ì—…ì„ í•˜ê²Œ ë§Œë“œëŠ” ê³µê²© ë°©ë²•
    - ìš”ì²­ ì‹œ CSRF Tokenì„ í•¨ê»˜ ë³´ë‚´ì•¼ í•˜ëŠ” ì´ìœ 
        - Django ì„œë²„ëŠ” í•´ë‹¹ ìš”ì²­ì´ DBì— ë°ì´í„°ë¥¼ í•˜ë‚˜ ìƒì„±í•˜ëŠ” (DBì— ì˜í–¥ì„ ì£¼ëŠ) ìš”ì²­ì— ëŒ€í•´ â€œDjango ê°€ ì§ì ‘ ì œê³µí•œ í˜ì´ã…£ì—ì„œ ë°ì´í„°ë¥¼ ì‘ì„±í•˜ê³  ìˆëŠ”ì§€ì— ëŒ€í•œ í™•ì¸ ìš”ì†Œ í•„ìš”
        - ê²‰ëª¨ìŠµì´ ë˜‘ê°™ì€ ìœ„ì¡° ì‚¬ì´íŠ¸ë‚˜ ì •ìƒì ì´ì§€ ì•Šì€ ìš”ì²­ì— ëŒ€í•œ ë°©ì–´ ìˆ˜ë‹¨
        - ê¸°ì¡´ - ìš”ì²­ ë°ì´í„° â†’ ê²Œì‹œê¸€ ì‘ì„±
        - ë³€ê²½ - ìš”ì²­ ë°ì´í„° + ì¸ì¦ í† í° â†’ ê²Œì‹œê¸€ ì‘ì„±
    - POSTì¼ ë•Œë§Œ Tokenì„ í™•ì¸í•˜ëŠ” ì´ìœ 
        - POSTëŠ” ë‹¨ìˆœ ì¡°íšŒë¥¼ ìœ„í•œ GETê³¼ ë‹¬ë¦¬ íŠ¹ì • ë¦¬ì†ŒìŠ¤ì— ë³€ê²½
        - DBì— ì¡°ì‘ì„ ê°€í•˜ëŠ” ìš”ì²­ì€ ë°˜ë“œì‹œ ì¸ì¦ ìˆ˜ë‹¨ì´ í•„ìš”
        - ë°ì´í„°ë² ì´ìŠ¤ì— ëŒ€í•œ ë³€ê²½ì‚¬í•­ì„ ë§Œë“œëŠ” ìš”ì²­ì´ê¸° ë•Œë¬¸ì— í† í°ì„ ì‚¬ìš©í•˜ì—¬ ìµœì†Œí•œì˜ ì‹ ì›ì„ í™•ì¸í•˜ëŠ” ê²ƒ
- redirect
    - í´ë¼ì´ì–¸íŠ¸ê°€ ì¸ìì— ì‘ì„±ëœ ì£¼ì†Œë¡œ ë‹¤ì‹œ ìš”ì²­ì„ ë³´ë‚´ë„ë¡ í•˜ëŠ” í•¨ìˆ˜
    - ê²Œì‹œê¸€ ì‘ì„± í›„ ì™„ë£Œë¥¼ ì•Œë¦¬ëŠ” í˜ì´ì§€ë¥¼ ì‘ë‹µí•˜ëŠ” ê²ƒ
    - ë°ì´í„° ì €ì¥ í›„ í˜ì´ì§€ë¥¼ ì£¼ëŠ” ê²ƒì´ ì•„ë‹Œ ë‹¤ë¥¸ í˜ì´ì§€ë¡œ ì‚¬ìš©ìë¥¼ ë³´ë‚´ì•¼ í•¨
    
    ```python
    # articles/views.py
    
    from django.shortcuts import render, redirect
    
    def create(request):
        title = request.GET.get('title')
        content = request.GET.get('content')
    
        article = Article(title=title, content=content)
        article.save()
    
        return redirect('articles:detail', article.pk)
    ```
    
    - í•´ë‹¹ redirectì—ì„œ í´ë¼ì´ì–¸íŠ¸ëŠ” detail urlë¡œ ìš”ì²­ì„ ë‹¤ì‹œ ë³´ë‚´ê²Œ ë¨
    - ê²°ê³¼ì ìœ¼ë¡œ detail view í•¨ìˆ˜ê°€ í˜¸ì¶œë˜ì–´ detail view í•¨ìˆ˜ì˜ ë°˜í™˜ ê²°ê³¼ì¸ detail í˜ì´ì§€ë¥¼ ì‘ë‹µ ë°›ìŒ
    - ê²°êµ­ ì‚¬ìš©ìëŠ” ê²Œì‹œê¸€ ì‘ì„± í›„ ì‘ì„±ëœ ê²Œì‹œê¸€ì˜ detail í˜ì´ì§€ë¡œ ì´ë™í•˜ëŠ” ê²ƒìœ¼ë¡œ ëŠë¼ê²Œ ë˜ëŠ” ê²ƒ

#### Delete

```python
# articles/urls.py

from django.urls import path
from . import views

app_name = 'articles'

urlpatterns = [
    ...
    path('<int:pk>/delete/', views.delete, name='delete'),
]
```

```python
# article.views.py

def delete(request, pk):
    article = Article.objects.get(pk=pk)
    article.delete()
    return redirect('articles:index')
```

```html
<!-- templates/articles/detail.html -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>
<body>
  <h2>DETAIL</h2>
  <h3>{{article.pk}} ë²ˆì§¸ ê¸€</h3>
  <hr>
  <p>ì œëª©: {{article.title}}</p>
  <p>ë‚´ìš©: {{article.content}}</p>
  <p>ì‘ì„± ì‹œê°: {{article.created_at}}</p>
  <p>ìˆ˜ì • ì‹œê°: {{article.updated_at}}</p>
  <hr>
  <form action="{% url "articles:delete" article.pk %}" method="POST">
    <input type="submit" value="DELETE">
  </form>
  <a href="{% url "articles:index" %}">[back]</a>
</body>
</html>
```

#### Update

```python
# articles/urls.py

from django.urls import path
from . import views

app_name = 'articles'

urlpatterns = [
    ...
    path('<int:pk>/edit/', views.edit, name='edit'),
    path('<int:pk>/update', views.update, name='update'),
]
```

```python
# articles/views.py

def edit(request, pk):
    article = Article.objects.get(pk=pk)
    context = {
        'article': article,
    }
    return render(request, 'articles/edit.html', context)

def update(request, pk):
    article = Article.objects.get(pk=pk)
    article.title = request.POST.get('title')
    article.content = request.POST.get('content')
    article.save()

    return redirect('articles:detail', article.pk)
```

```html
<!-- templates/articles/edit.html -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>
<body>
  <h1>EDIT</h1>
  <form action="{% url "articles:update" article.pk %}" method="POST">
    {% csrf_token %}
    <div>
      <label for="title">Title: </label>
      <input type="text" id="title" name="title" value="{{article.title}}">
    </div>
    <div>
      <label for="content">Content: </label>
      <textarea name="content" id="content">{{article.content}}</textarea>
    </div>
    <input type="submit" value="ì œì¶œ">
  </form>
  <hr>
  <a href="{% url "articles:detail" article.pk %}">[back]</a>
</body>
</html>
```

## Django Form

- ì‚¬ìš©ì ì…ë ¥ ë°ì´í„°ë¥¼ ìˆ˜ì§‘í•˜ê³ , ì²˜ë¦¬ ë° ìœ íš¨ì„± ê²€ì‚¬ë¥¼ ìˆ˜í–‰í•˜ê¸° ìœ„í•œ ë„êµ¬
- ìœ íš¨ì„± ê²€ì‚¬ë¥¼ ë‹¨ìˆœí™”í•˜ê³  ìë™í™” í•  ìˆ˜ ìˆëŠ” ê¸°ëŠ¥ì„ ì œê³µ
- HTML formì˜ ìƒì„±, ë°ì´í„° ìœ íš¨ì„± ê²€ì‚¬ ë° ì²˜ë¦¬ë¥¼ ì‰½ê²Œ í•  ìˆ˜ ìˆë„ë¡ ë„ì›€

### HTML â€˜formâ€™ ì˜ í•œê³„

- form íƒœê·¸ëŠ” ì§€ê¸ˆê¹Œì§€ ì‚¬ìš©ìë¡œë¶€í„° ë°ì´í„°ë¥¼ ë°›ê¸° ìœ„í•´ í™œìš©í•œ ë°©ë²•
- ë¹„ì •ìƒì  í˜¹ì€ ì•…ì˜ì ì¸ ìš”ì²­ì„ í•„í„°ë§ í•  ìˆ˜ ì—†ìŒ
    - ìˆ˜ì§‘í•œ ë°ì´í„°ê°€ ì •í™•í•˜ê³  ìœ íš¨í•œì§€ì— ëŒ€í•œ í™•ì¸ì´ í•„ìš”(ìœ íš¨ì„± ê²€ì‚¬)
        - ìœ íš¨ì„± ê²€ì‚¬ë¥¼ êµ¬í˜„í•˜ê¸° ìœ„í•´ì„œëŠ” ì…ë ¥ ê°’, í˜•ì‹, ì¤‘ë³µ, ë²”ìœ„, ë³´ì•ˆ ë“± ë§ì€ ê²ƒë“¤ì„ ê³ ë ¤í•´ì•¼ í•¨
        - ì´ëŸ° ê³¼ì •ê³¼ ê¸°ëŠ¥ì„ ì§ì ‘ ê°œë°œí•˜ëŠ” ê²ƒì´ ì•„ë‹Œ Djangoê°€ ì œê³µí•˜ëŠ” Formì„ ì‚¬ìš©

### Form class ì •ì˜

```python
# articles/forms.py

from django import forms

class ArticleForm(forms.Form):
    title = forms.CharField(max_length=10)
    content = forms.CharField()
```

```python
# articles/views.py

def new(request):
    form = ArticleForm()
    context = {
        'form': form,
    }
    return render(request, 'articles/new.html', context)
```

```html
<!-- templates/articles/new.html -->
<body>
  <h1>NEW</h1>
  <form action="{% url "articles:create" %}" method="POST">
    {% csrf_token %}
    {{ form.as_p }}    <!-- form rendering options -->
    <input type="submit">
  </form>
  <hr>
  <a href="{% url 'articles:index' %}">[back]</a>
</body>
```

#### Form rendering options

- label, input ìŒì„ íŠ¹ì • HTML íƒœê·¸ë¡œ ê°ì‹¸ëŠ” ì˜µì…˜
    - [https://docs.djangoproject.com/en/4.2/topics/forms/#form-rendering-options](https://docs.djangoproject.com/en/4.2/topics/forms/#form-rendering-options)

### Widgets

- HTML â€˜inputâ€™ elementì˜ í‘œí˜„ì„ ë‹´ë‹¹
- Widgetì€ ë‹¨ìˆœíˆ input ìš”ì†Œì˜ ì†ì„± ë° ì¶œë ¥ë˜ëŠ” ë¶€ë¶„ì„ ë³€ê²½í•˜ëŠ” ê²ƒ
    - https://docs.djangoproject.com/ko/4.2/ref/forms/widgets/#built-in-widgets

```python
# articles/forms.py

from django import forms

class ArticleForm(forms.Form):
	title = form.CharField(max_length=10)
	content = forms.CharField(widget=forms.Textarea)
```

## Django ModelForm

- Modelê³¼ ì—°ê²°ëœ Formì„ ìë™ìœ¼ë¡œ ìƒì„±í•´ì£¼ëŠ” ê¸°ëŠ¥ì„ ì œê³µ
    - Form + Model

| Form | ModelForm |
| --- | --- |
| ì‚¬ìš©ì ì…ë ¥ ë°ì´í„°ë¥¼ DBì— ì €ì¥í•˜ì§€ ì•Šì„ ë•Œ | ì‚¬ìš©ì ì…ë ¥ ë°ì´í„°ë¥¼ DBì— ì €ì¥í•´ì•¼ í•  ë•Œ |
| ë¡œê·¸ì¸ | ê²Œì‹œê¸€, íšŒì›ê°€ì… |

### ModelForm class ì •ì˜

- ê¸°ì¡´ ArticleForm í´ë˜ìŠ¤ ìˆ˜ì •

```python
# articles/forms.py

from django import forms
from .models import Article

class ArticleForm(forms.ModelForm):
    
    class Meta:
        model = Article
        fields = '__all__'
```

#### Meta class

- ModelFormì˜ ì •ë³´ë¥¼ ì‘ì„±í•˜ëŠ” ê³³
- â€˜fieldsâ€™ ë° â€˜excludeâ€™ ì†ì„±
    - exclude ì†ì„±ì„ ì‚¬ìš©í•˜ì—¬ ëª¨ë¸ì—ì„œ í¬í•¨í•˜ì§€ ì•Šì„ í•„ë“œë¥¼ ì§€ì •í•  ìˆ˜ë„ ìˆìŒ

```python
# articles/forms.py

class ArticleForm(forms.ModelForm):
	class Meta:
		model = Article
		fields = ('title',)
```

```python
# articles/forms.py

class ArticleForm(forms.ModelForm):
	class Meta:
		model = Article
		exclude = ('title',)
```

- ModelForm ì ìš©í•œ create ë¡œì§

#### is_valid()

- ì—¬ëŸ¬ ìœ íš¨ì„± ê²€ì‚¬ë¥¼ ì‹¤í–‰í•˜ê³ , ë°ì´í„°ê°€ ìœ íš¨í•œì§€ ì—¬ë¶€ë¥¼ Booleanìœ¼ë¡œ ë°˜í™˜

```python
# articles/views.py

def create(request):
    form = ArticleForm(request.POST)
    if form.is_valid():
        article = form.save()
        return redirect('articles:detail', article.pk)
    context = {
        'form': form,
    }
    return render(request, 'articles/new.html', context)
```

- ModelFormì„ ì ìš©í•œ edit ë¡œì§

```python
# articles.views.py

def edit(request, pk):
    article = Article.objects.get(pk=pk)
    form = ArticleForm(instance=article)
    context = {
        'article': article,
        'form': form,
    }
    return render(request, 'articles/edit.html', context)
```

```html
<!-- articles/edit.html -->

<body>
  <h1>Edit</h1>
  <form action="{% url "articles:update" article.pk %}" method="POST">
    {% csrf_token %}
    {{ form.as_p }}
    <input type="submit">
  </form>
  <hr>
  <a href="{% url 'articles:index' %}">[back]</a>
</body>
```

- ModelFormì„ ì ìš©í•œ update ë¡œì§

```python
# articles/views.py

def update(request, pk):
    article = Article.objects.get(pk=pk)
    form = ArticleForm(request.POST, instance=article)
    if form.is_valid():
        form.save()
        return redirect('articles:detail', article.pk)
    context = {
        'form': form,
    }
    return render(request, 'articles/edit.html', context)
```

#### save()

- ë°ì´í„°ë² ì´ìŠ¤ ê°ì²´ë¥¼ ë§Œë“¤ê³  ì €ì¥
- í‚¤ì›Œë“œ ì¸ì instance ì—¬ë¶€ë¥¼ í†µí•´ ìƒì„±í•  ì§€, ìˆ˜ì •í•  ì§€ë¥¼ ê²°ì •

## Handling HTTP requests

### view í•¨ìˆ˜ êµ¬ì¡° ë³€í™”

- new, create í•¨ìˆ˜
    - ê³µí†µì  - ë°ì´í„° ìƒì„±ì„ êµ¬í˜„í•˜ê¸° ìœ„í•¨
    - ì°¨ì´ì  - newëŠ” GET method ìš”ì²­ë§Œì„ createëŠ” POST method ìš”ì²­ë§Œì„ ì²˜ë¦¬
- new, create í•¨ìˆ˜ ê²°í•©

```python
# articles/views.py

def create(request):
    if request.method == 'POST':
        form = ArticleForm(request.POST)
        if form.is_valid():
            article = form.save()
            return redirect('articles:detail', article.pk)
    else:
        form = ArticleForm()
    context = {
        'form': form,
    }
    return render(request, 'articles/new.html', context
```

- edit, update í•¨ìˆ˜ ê²°í•©

```python
# articles/views.py

def update(request, pk):
    article = Article.objects.get(pk=pk)
    if request.method == 'POST':
        form = ArticleForm(request.POST, instance=article)
        if form.is_valid():
            form.save()
            return redirect('articles:detail', article.pk)
    else:
        form = ArticleForm(instance=article)
    context = {
        'article': article,
        'form': form,
    }
    return render(request, 'articles/update.html', context)
```

## Static Files

ì„œë²„ ì¸¡ì—ì„œ ë³€ê²½ë˜ì§€ ì•Šê³  ê³ ì •ì ìœ¼ë¡œ ì œê³µë˜ëŠ” íŒŒì¼(ì´ë¯¸ì§€, JS, CSS íŒŒì¼ ë“±)

### ì›¹ ì„œë²„ì™€ ì •ì  íŒŒì¼

- ì›¹ ì„œë²„ì˜ ê¸°ë³¸ ë™ì‘ì€ íŠ¹ì • ìœ„ì¹˜(URL)ì— ìˆëŠ” ìì›ì„ ìš”ì²­(HTTP request) ë°›ì•„ì„œ ì‘ë‹µ(HTTP response)ì„ ì²˜ë¦¬í•˜ê³  ì œê³µ(serving)í•˜ëŠ” ê²ƒ
    - â€œìì›ì— ì ‘ê·¼ ê°€ëŠ¥í•œ ì£¼ì†Œê°€ ìˆë‹¤â€
- ì›¹ ì„œë²„ëŠ” ìš”ì²­ ë°›ì€ URLë¡œ ì„œë²„ì— ì¡´ì¬í•˜ëŠ” ì •ì  ìì›ì„ ì œê³µ
- ì •ì  íŒŒì¼ì„ ì œê³µí•˜ê¸° ìœ„í•œ ê²½ë¡œ(URL)ê°€ ìˆì–´ì•¼ í•¨

### Static files ì œê³µí•˜ê¸°

1. ê¸°ë³¸ ê²½ë¡œì—ì„œ ì œê³µí•˜ê¸°
    - appí´ë”/static
        
        ![Untitled 17](https://github.com/yuj1818/TIL/assets/95585314/290f2a7b-c513-4fa9-a58c-36238d013fc7)
        
    - static tagë¥¼ ì‚¬ìš©í•´ ì´ë¯¸ì§€ íŒŒì¼ì— ëŒ€í•œ url ì œê³µ
    
    ```html
    {% load static %}
    <!DOCTYPE html>
    <html lang="en">
    <head>
      <meta charset="UTF-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <title>Document</title>
    </head>
    <body>
      <img src="{% static "articles/sample-1.png" %}" alt="img">
    </body>
    </html>
    ```
    
    - STATIC_URL
        - ê¸°ë³¸ ê²½ë¡œ ë° ì¶”ê°€ ê²½ë¡œì— ìœ„ì¹˜í•œ ì •ì  íŒŒì¼ì„ ì°¸ì¡°í•˜ê¸° ìœ„í•œ URL
        - ì‹¤ì œ íŒŒì¼ì´ë‚˜ ë””ë ‰í† ë¦¬ê°€ ì•„ë‹ˆë©°, URLë¡œë§Œ ì¡´ì¬
        
        ```python
        # settings.py
        
        STATIC_URL = 'static/'
        ```
        
2. ì¶”ê°€ ê²½ë¡œì—ì„œ ì œê³µí•˜ê¸°
    - STATICFILES_DIRSì— ë¬¸ìì—´ ê°’ìœ¼ë¡œ ì¶”ê°€ ê²½ë¡œ ì„¤ì •
    
    ```python
    # settings.py
    
    STATICFILES_DIRS = [
    	BASE_DIR / 'static',
    ]
    ```
    
    `STATICFILES_DIRS` : ì •ì  íŒŒì¼ì˜ ê¸°ë³¸ ê²½ë¡œ ì™¸ì— ì¶”ê°€ì ì¸ ê²½ë¡œ ëª©ë¡ì„ ì •ì˜í•˜ëŠ” ë¦¬ìŠ¤íŠ¸
    
    - ì¶”ê°€ ê²½ë¡œì— ì´ë¯¸ì§€ íŒŒì¼ ë°°ì¹˜
        
        ![Untitled 18](https://github.com/yuj1818/TIL/assets/95585314/17706371-15b8-4597-b18d-1aff9f39834c)
        
    - static tagë¥¼ ì‚¬ìš©í•´ ì´ë¯¸ì§€ íŒŒì¼ì— ëŒ€í•œ url ì œê³µ
    
    ```html
    <!-- articles/index.html -->
    
    <img src="{% static 'sample-2.png' %}" alt="img">
    ```
    
- **ì •ì  íŒŒì¼ì„ ì œê³µí•˜ë ¤ë©´ ìš”ì²­ì— ì‘ë‹µí•˜ê¸° ìœ„í•œ URLì´ í•„ìš”**

## Media files

ì‚¬ìš©ìê°€ ì›¹ì—ì„œ ì—…ë¡œë“œí•˜ëŠ” ì •ì  íŒŒì¼(user-uploaded)

### ë¯¸ë””ì–´ íŒŒì¼ ì œê³µ

1. settings.pyì— MEDIA_ROOT, MEDIA_URL ì„¤ì •
    - ì—…ë¡œë“œ ëœ íŒŒì¼ì˜ URL â‡’ settings.MEDIA_URL
    - ìœ„ URLì„ ì°¸ì¡°í•˜ëŠ” íŒŒì¼ì˜ ì‹¤ì œ ìœ„ì¹˜ â‡’ settings.MEDIA_ROOT
    
    `MEDIA_ROOT` : ë¯¸ë””ì–´ íŒŒì¼ë“¤ì´ ìœ„ì¹˜í•˜ëŠ” ë””ë ‰í† ë¦¬ì˜ ì ˆëŒ€ ê²½ë¡œ
    
    `MEDIA_URL` : MEDIA_ROOTì—ì„œ ì œê³µë˜ëŠ” ë¯¸ë””ì–´ íŒŒì¼ì— ëŒ€í•œ ì£¼ì†Œë¥¼ ìƒì„±
    
    ```python
    # settings.py
    
    MEDIA_URL = 'media/'
    
    MEDIA_ROOT = BASE_DIR / 'media'
    ```
    
2. ì‘ì„±í•œ MEDIA_ROOTì™€ MEDIA_URLì— ëŒ€í•œ url ì§€ì •

```python
# crud/urls.py

from django.conf import settings
from django.conf.urls.static import static

urlpatterns = [
	...
	] + static(settings.MEDIA_URL, document_root=settings.MEDIA_ROOT)
```

### ì´ë¯¸ì§€ ì—…ë¡œë“œ

- blank=True ì†ì„±ì„ ì‘ì„±í•´ ë¹ˆ ë¬¸ìì—´ì´ ì €ì¥ë  ìˆ˜ ìˆë„ë¡ ì œì•½ ì¡°ê±´ ì„¤ì •

```python
# articles/models.py

class Article(models.Model):
	title = models.CharField(max_length=10)
	content = models.TextField()
	image = models.ImageField(blank=True)
	created_at = models.DatetimeField(auto_now_add=True)
	updated_at = models.DatetimeField(auto_now=True)
```

- migrations ì§„í–‰
- form ìš”ì†Œì˜ enctype ì†ì„± ì¶”ê°€

```html
<!-- articles/create.html -->
  <form action="{% url "articles:create" %}" method="POST" enctype="multipart/form-data">
    {% csrf_token %}
    {{ form.as_p }}
    <input type="submit">
  </form>
```

- view í•¨ìˆ˜ì—ì„œ ì—…ë¡œë“œ íŒŒì¼ì— ëŒ€í•œ ì¶”ê°€ ì½”ë“œ ì‘ì„±

```python
# articles/views.py

def create(request):
	if request.method == 'POST':
		form = ArticleForm(request.POST, request.FILES)
```

`ImageField()`

- ì´ë¯¸ì§€ ì—…ë¡œë“œì— ì‚¬ìš©í•˜ëŠ” ëª¨ë¸ í•„ë“œ
- ì´ë¯¸ì§€ ê°ì²´ê°€ ì§ì ‘ ì €ì¥ë˜ëŠ” ê²ƒì´ ì•„ë‹Œ '**ì´ë¯¸ì§€ íŒŒì¼ì˜ ê²½ë¡œ**'ê°€ ë¬¸ìì—´ë¡œ DBì— ì €ì¥
    - ì„±ëŠ¥ ë° DB ìµœì í™”
        - ì§ì ‘ íŒŒì¼ì„ ì €ì¥í•˜ë©´ DB í¬ê¸°ê°€ ê¸‰ê²©í•˜ê²Œ ì¦ê°€
            - ì„±ëŠ¥ì´ ì €í•˜
            - íŒŒì¼ ìì²´ëŠ” íŒŒì¼ì‹œìŠ¤í…œì— ë³„ë„ë¡œ ì €ì¥
            - DBì—ëŠ” ê·¸ íŒŒì¼ì— ëŒ€í•œ ë¬¸ìì—´ ê²½ë¡œë§Œ
    - ìœ ì§€ ë³´ìˆ˜ ê´€ì 
        - DBì— ì§ì ‘ íŒŒì¼ì— ì €ì¥í•´ë²„ë¦¬ë©´ íŒŒì¼ì„ ë³€ê²½í•˜ê±°ë‚˜ ì—…ë°ì´íŠ¸ í•  ë•Œ, DBë¥¼ ì§ì ‘ ì¡°ì‘í•´ì•¼ í•¨
        - í•˜ì§€ë§Œ, DBì— ê²½ë¡œë§Œ ì €ì¥ë˜ì–´ ìˆë‹¤ë©´ íŒŒì¼ì‹œìŠ¤í…œì—ì„œë§Œ íŒŒì¼ì„ ìˆ˜ì •í•˜ë©´ ë˜ë¯€ë¡œ ìœ ì§€ ë³´ìˆ˜ì— ìš©ì´

### ì—…ë¡œë“œ ì´ë¯¸ì§€ ì œê³µ

- â€˜urlâ€™ ì†ì„±ì„ í†µí•´ ì—…ë¡œë“œ íŒŒì¼ì˜ ê²½ë¡œ ê°’ì„ ì–»ì„ ìˆ˜ ìˆìŒ
- article.image.url
    - ì—…ë¡œë“œ íŒŒì¼ì˜ ê²½ë¡œ
- article.image
    - ì—…ë¡œë“œ íŒŒì¼ì˜ íŒŒì¼ ì´ë¦„

```html
<!-- articles/detail.html -->

<img src="{{ article.image.url }}" alt="img">
```

- ì´ë¯¸ì§€ë¥¼ ì—…ë¡œë“œ í•˜ì§€ ì•Šì€ ê²Œì‹œë¬¼ì€ detail í…œí”Œë¦¿ì„ ë Œë”ë§ í•  ìˆ˜ ì—†ìŒ
- ì´ë¯¸ì§€ ë°ì´í„°ê°€ ìˆëŠ” ê²½ìš°ë§Œ ì´ë¯¸ì§€ë¥¼ ì¶œë ¥í•  ìˆ˜ ìˆë„ë¡ ì²˜ë¦¬

```html
<!-- articles/detail.html -->

{% if article.image %}
  <img src="{{ article.image.url }}" alt="img">
{% endif %}
```

- ìˆ˜ì • í˜ì´ì§€ form ìš”ì†Œì—ë„ enctype ì†ì„± ì¶”ê°€
    - update html formì— enctype ì¶”ê°€
- update view í•¨ìˆ˜ì—ì„œ ì—…ë¡œë“œ íŒŒì¼ì— ëŒ€í•œ ì¶”ê°€ ì½”ë“œ ì‘ì„±
    - update view í•¨ìˆ˜ form ì •ì˜ ë¶€ë¶„ì— request.FILES ì¶”ê°€

## ì°¸ê³ 

### Django í”„ë¡œì íŠ¸ ìƒì„± ë£¨í‹´ ì •ë¦¬ + git

- ê°€ìƒí™˜ê²½ ìƒì„±
- ê°€ìƒí™˜ê²½ í™œì„±í™”
- django ì„¤ì¹˜
- ì˜ì¡´ì„± íŒŒì¼ ìƒì„±(íŒ¨í‚¤ì§€ ì„¤ì¹˜ì‹œë§ˆë‹¤ ì§„í–‰)
- .gitignore íŒŒì¼ ìƒì„±(ì²« add ì „)
- git ì €ì¥ì†Œ ìƒì„±
- Django í”„ë¡œì íŠ¸ ìƒì„±

### ê°€ìƒí™˜ê²½ì„ ì‚¬ìš©í•˜ëŠ” ì´ìœ 

- ì˜ì¡´ì„± ê´€ë¦¬
    - ë¼ì´ë¸ŒëŸ¬ë¦¬ ë° íŒ¨í‚¤ì§€ë¥¼ ê° í”„ë¡œì íŠ¸ë§ˆë‹¤ ë…ë¦½ì ìœ¼ë¡œ ì‚¬ìš© ê°€ëŠ¥
- íŒ€ í”„ë¡œì íŠ¸ í˜‘ì—…
    - ëª¨ë“  íŒ€ì›ì´ ë™ì¼í•œ í™˜ê²½ê³¼ ì˜ì¡´ì„± ìœ„ì—ì„œ ì‘ì—…í•˜ì—¬ ë²„ì „ê°„ ì¶©ëŒì„ ë°©ì§€

### LTS(Long-Term Support)

- í”„ë ˆì„ì›Œí¬ë‚˜ ë¼ì´ë¸ŒëŸ¬ë¦¬ ë“±ì˜ ì†Œí”„íŠ¸ì›¨ì–´ì—ì„œ ì¥ê¸°ê°„ ì§€ì›ë˜ëŠ” ì•ˆì •ì ì¸ ë²„ì „ì„ ì˜ë¯¸í•  ë•Œ ì‚¬ìš©
- ê¸°ì—…ì´ë‚˜ ëŒ€ê·œëª¨ í”„ë¡œì íŠ¸ì—ì„œëŠ” ì†Œí”„íŠ¸ì›¨ì–´ ì—…ê·¸ë ˆì´ë“œì— ë§ì€ ë¹„ìš©ê³¼ ì‹œê°„ì´ í•„ìš”í•˜ê¸° ë•Œë¬¸ì— ì•ˆì •ì ì´ê³  ì¥ê¸°ê°„ ì§€ì›ë˜ëŠ” ë²„ì „ì´ í•„ìš”
- https://www.djangoproject.com/download/

### requirements ì„¤ì¹˜ ë°©ë²•

```bash
# requirements.txtì— ìˆëŠ” íŒ¨í‚¤ì§€ ì„¤ì¹˜ ë°©ë²•
$ pip install -r requirements.txt
```

### MTV ë””ìì¸ íŒ¨í„´ ì •ë¦¬

- Model
    - ë°ì´í„°ì™€ ê´€ë ¨ëœ ë¡œì§ì„ ê´€ë¦¬
    - ì‘ìš© í”„ë¡œê·¸ë¨ì˜ ë°ì´í„° êµ¬ì¡°ë¥¼ ì •ì˜í•˜ê³  ë°ì´í„°ë² ì´ìŠ¤ì˜ ê¸°ë¡ì„ ê´€ë¦¬
- Template
    - ë ˆì´ì•„ì›ƒê³¼ í™”ë©´ì„ ì²˜ë¦¬
    - í™”ë©´ìƒì˜ ì‚¬ìš©ì ì¸í„°í˜ì´ìŠ¤ êµ¬ì¡°ì™€ ë ˆì´ì•„ì›ƒì„ ì •ì˜
- View
    - Model & Templateê³¼ ê´€ë ¨í•œ ë¡œì§ì„ ì²˜ë¦¬í•´ì„œ ì‘ë‹µì„ ë°˜í™˜
    - í´ë¼ì´ì–¸íŠ¸ì˜ ìš”ì²­ì— ëŒ€í•´ ì²˜ë¦¬ë¥¼ ë¶„ê¸°í•˜ëŠ” ì—­í• 
- View ì˜ˆì‹œ
    - ë°ì´í„°ê°€ í•„ìš”í•˜ë‹¤ë©´ modelì— ì ‘ê·¼í•´ì„œ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜´
    - ê°€ì ¸ì˜¨ ë°ì´í„°ë¥¼ templateë¡œ ë³´ë‚´ í™”ë©´ì„ êµ¬ì„±
    - êµ¬ì„±ëœ í™”ë©´ì„ ì‘ë‹µìœ¼ë¡œ ë§Œë“¤ì–´ í´ë¼ì´ì–¸íŠ¸ì—ê²Œ ë°˜í™˜

![Untitled 5](https://github.com/yuj1818/TIL/assets/95585314/188e34b5-8471-4d15-ac0b-60f98062391c)

### render í•¨ìˆ˜

- ì£¼ì–´ì§„ í…œí”Œë¦¿ì„ ì£¼ì–´ì§„ ì»¨í…ìŠ¤íŠ¸ ë°ì´í„°ì™€ ê²°í•©í•˜ê³  ë Œë”ë§ ëœ í…ìŠ¤íŠ¸ì™€ í•¨ê»˜ HttpResponse(ì‘ë‹µ) ê°ì²´ë¥¼ ë°˜í™˜í•˜ëŠ” í•¨ìˆ˜
- request
    - ì‘ë‹µì„ ìƒì„±í•˜ëŠ” ë° ì‚¬ìš©ë˜ëŠ” ìš”ì²­ ê°ì²´
- template_name
    - í…œí”Œë¦¿ ì´ë¦„ì˜ ê²½ë¡œ
- context
    - í…œí”Œë¦¿ì—ì„œ ì‚¬ìš©í•  ë°ì´í„°(ë”•ì…”ë„ˆë¦¬ íƒ€ì…ìœ¼ë¡œ ì‘ì„±)

```python
render(request, template_name, context)
```

### ì¶”ê°€ í…œí”Œë¦¿ ê²½ë¡œ ì§€ì •

- í…œí”Œë¦¿ ê¸°ë³¸ ê²½ë¡œ ì™¸ ì»¤ìŠ¤í…€ ê²½ë¡œ ì¶”ê°€í•˜ê¸°

```python
# setting.py
TEMPLATES = [
    {
        'BACKEND': 'django.template.backends.django.DjangoTemplates',
        'DIRS': [BASE_DIR / 'templates'],
        'APP_DIRS': True,
        'OPTIONS': {
            'context_processors': [
                'django.template.context_processors.debug',
                'django.template.context_processors.request',
                'django.contrib.auth.context_processors.auth',
                'django.contrib.messages.context_processors.messages',
            ],
        },
    },
]
```

- ìµœìƒìœ„ í´ë”ì— templates í´ë” ë§Œë“¤ì–´ì„œ ê·¸ ì•ˆì— base.html ìƒì„±
- extends ê²½ë¡œ ìˆ˜ì •

```html
{% extends 'base.html' %}
```

#### BASE_DIR

- settingsì—ì„œ ê²½ë¡œ ì§€ì •ì„ í¸í•˜ê²Œ í•˜ê¸° ìœ„í•´ ìµœìƒë‹¨ ì§€ì ì„ ì§€ì • í•´ë†“ì€ ë³€ìˆ˜

### DTL ì£¼ì˜ì‚¬í•­

- Pythonì²˜ëŸ¼ ì¼ë¶€ í”„ë¡œê·¸ë˜ë° êµ¬ì¡°(if, for ë“±)ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆì§€ë§Œ ëª…ì¹­ì„ ê·¸ë ‡ê²Œ ì„¤ê³„í–ˆì„ ë¿ì´ì§€ Python ì½”ë“œë¡œ ì‹¤í–‰ë˜ëŠ” ê²ƒì´ ì•„ë‹ˆë©° Pythonê³¼ëŠ” ê´€ë ¨ ì—†ìŒ
- í”„ë¡œê·¸ë˜ë°ì  ë¡œì§ì€ ë˜ë„ë¡ view í•¨ìˆ˜ì—ì„œ ì‘ì„± ë° ì²˜ë¦¬
- ê³µì‹ë¬¸ì„œë¥¼ ì°¸ê³ í•´ ë‹¤ì–‘í•œ íƒœê·¸ì™€ í•„í„° ì‚¬ìš©í•´ë³´ê¸°
    - [https://docs.djangoproject.com/en/4.2/ref/templates/builtins/](https://docs.djangoproject.com/en/4.2/ref/templates/builtins/)

### Trailing Slashes

- DjangoëŠ” URL ëì— â€˜/â€™ê°€ ì—†ë‹¤ë©´ ìë™ìœ¼ë¡œ ë¶™ì„
- â€œê¸°ìˆ ì ì¸ ì¸¡ë©´ì—ì„œ, [foo.com/barì™€](http://foo.com/barì™€) [foo.com/bar/ëŠ”](http://foo.com/bar/ëŠ”) ì„œë¡œ ë‹¤ë¥¸ URLâ€
    - ê²€ìƒ‰ ì—”ì§„ ë¡œë´‡ì´ë‚˜ ì›¹ íŠ¸ë˜í”½ ë¶„ì„ ë„êµ¬ì—ì„œëŠ” ì´ ë‘ ì£¼ì†Œë¥¼ ì„œë¡œ ë‹¤ë¥¸ í˜ì´ì§€ë¡œ ë´„
- ê·¸ë˜ì„œ DjangoëŠ” ê²€ìƒ‰ ì—”ì§„ì´ í˜¼ë™í•˜ì§€ ì•Šê²Œ í•˜ê¸° ìœ„í•´ ë¶™ì´ëŠ” ê²ƒì„ ì„ íƒí•œ ê²ƒ
- ê·¸ëŸ¬ë‚˜ ëª¨ë“  í”„ë ˆì„ì›Œí¬ê°€ ì´ë ‡ê²Œ ë™ì‘í•˜ëŠ” ê²ƒì€ ì•„ë‹ˆë‹ˆ ì£¼ì˜

### ë°ì´í„°ë² ì´ìŠ¤ ì´ˆê¸°í™”

- migration íŒŒì¼ ì‚­ì œ(ex: 0001_initial.py)
- db.sqlite3 íŒŒì¼ ì‚­ì œ
- **/__init/__.py íŒŒì¼ì´ë‚˜ migrations í´ë”ë¥¼ ì§€ìš°ì§€ ì•Šë„ë¡ ì£¼ì˜ í•„ìš”**

### Migrations ê¸°íƒ€ ëª…ë ¹ì–´

```bash
$ python manage.py showmigrations
```

- migrations íŒŒì¼ë“¤ì´ migrate ëëŠ”ì§€ ì•ˆëëŠ”ì§€ ì—¬ë¶€ë¥¼ í™•ì¸í•˜ëŠ” ëª…ë ¹ì–´
- [X] í‘œì‹œê°€ ìˆìœ¼ë©´ migrateê°€ ì™„ë£Œë˜ì—ˆìŒì„ ì˜ë¯¸

![Untitled 17](https://github.com/yuj1818/TIL/assets/95585314/b2dc1898-23eb-4098-95e8-c474ff578f3e)

```bash
$ python manage.py sqlmigrate articles 0001
```

- í•´ë‹¹ migrations íŒŒì¼ì´ SQL ì–¸ì–´(DBì—ì„œ ì‚¬ìš©í•˜ëŠ” ì–¸ì–´)ë¡œ ì–´ë–»ê²Œ ë²ˆì—­ë˜ì–´ DBì— ì „ë‹¬ë˜ëŠ”ì§€ í™•ì¸í•˜ëŠ” ëª…ë ¹ì–´

![Untitled 18](https://github.com/yuj1818/TIL/assets/95585314/cd7e8ea1-0685-4e1c-9b19-85bbc0b40e9d)

### ì²« migrate ì‹œ ì¶œë ¥ ë‚´ìš©ì´ ë§ì€ ì´ìœ ëŠ”?

- Django í”„ë¡œì íŠ¸ê°€ ë™ì‘í•˜ê¸° ìœ„í•´ ë¯¸ë¦¬ ì‘ì„± ë˜ì–´ìˆëŠ” ê¸°ë³¸ ë‚´ì¥ appë“¤ì— ëŒ€í•œ migration íŒŒì¼ë“¤ì´ í•¨ê»˜ migrate ë˜ê¸° ë•Œë¬¸

### SQLite

- ë°ì´í„°ë² ì´ìŠ¤ ê´€ë¦¬ ì‹œìŠ¤í…œ ì¤‘ í•˜ë‚˜ì´ë©° Djangoì˜ ê¸°ë³¸ ë°ì´í„°ë² ì´ìŠ¤ë¡œ ì‚¬ìš©ë¨
- íŒŒì¼ë¡œ ì¡´ì¬í•˜ë©° ê°€ë³ê³  í˜¸í™˜ì„±ì´ ì¢‹ìŒ

### CRUD

- ì†Œí”„íŠ¸ì›¨ì–´ê°€ ê°€ì§€ëŠ” ê¸°ë³¸ì ì¸ ë°ì´í„° ì²˜ë¦¬ ê¸°ëŠ¥
- Create(ì €ì¥)
- Read(ì¡°íšŒ)
- Update(ê°±ì‹ )
- Delete(ì‚­ì œ)

### Field lookups

- íŠ¹ì • ë ˆì½”ë“œì— ëŒ€í•œ ì¡°ê±´ì„ ì„¤ì •í•˜ëŠ” ë°©ë²•
- QuerySet ë©”ì„œë“œ filter(), exclude() ë° get()ì— ëŒ€í•œ í‚¤ì›Œë“œ ì¸ìë¡œ ì§€ì •ë¨
- [https://docs.djangoproject.com/en/4.2/ref/models/querysets/#field-lookups](https://docs.djangoproject.com/en/4.2/ref/models/querysets/#field-lookups)

### ORM, QuerySet APIë¥¼ ì‚¬ìš©í•˜ëŠ” ì´ìœ 

- ë°ì´í„°ë² ì´ìŠ¤ ì¿¼ë¦¬ë¥¼ ì¶”ìƒí™”í•˜ì—¬ Django ê°œë°œìê°€ ë°ì´í„°ë² ì´ìŠ¤ì™€ ì§ì ‘ ìƒí˜¸ì‘ìš©í•˜ì§€ ì•Šì•„ë„ ë˜ë„ë¡ í•¨
- ë°ì´í„°ë² ì´ìŠ¤ì™€ì˜ ê²°í•©ë„ë¥¼ ë‚®ì¶”ê³  ê°œë°œìê°€ ë”ìš± ì§ê´€ì ì´ê³  ìƒì‚°ì ìœ¼ë¡œ ê°œë°œí•  ìˆ˜ ìˆë„ë¡ ë„ì›€

### QuerySet API ê´€ë ¨ ë¬¸ì„œ

- [https://docs.djangoproject.com/en/4.2/ref/models/querysets](https://docs.djangoproject.com/en/4.2/ref/models/querysets)
- [https://docs.djangoproject.com/en/4.2/topics/db/queries/](https://docs.djangoproject.com/en/4.2/topics/db/queries/)

### HTTP request methods ì‚¬ìš© ì˜ˆì‹œ

- HTTP request methodsë¥¼ í™œìš©í•œ íš¨ìœ¨ì ì¸ URL êµ¬ì„±
    - ë™ì¼í•œ URLì´ì§€ë§Œ methodì— ë”°ë¼ ì„œë²„ì— ìš”êµ¬í•˜ëŠ” í–‰ë™ì„ ë‹¤ë¥´ê²Œ ìš”êµ¬
        - (GET) articles/1/ â‡’ 1ë²ˆ ê²Œì‹œê¸€ ì¡°íšŒ ìš”ì²­
        - (POST) articles/1/ â‡’ 1ë²ˆ ê²Œì‹œê¸€ ì¡°ì‘ ìš”ì²­

### ModelForm í‚¤ì›Œë“œ ì¸ì dataì™€ instance ì‚´í´ë³´ê¸°

- https://github.com/django/django/blob/main/django/forms/models.py#L341

```python
class BaseModelForm(BaseForm):
	def __init__(self, data=None, files=None, auto_id='id_%s', prefix=None,
							 initial=None, error_class=ErrorList, label_suffix=None, 
               empty_permitted=False, instance=None, use_required_attribute=None,
               renderer=None):
```

### Widget ì‘ìš©

```python
# articles/forms.py

class ArticleForm(forms.ModelForm):
    title = forms.CharField(
        label='ì œëª©',
        widget=forms.TextInput(
            attrs={
                'class': 'my-title',
                'placeholder': 'Enter the title',
                'maxlength': 10,
            }
        )
    )
    content = forms.CharField(
        label='ë‚´ìš©',
        widget=forms.Textarea(
            attrs={
                'class': 'my-content',
                'placeholder': 'Enter the content',
                'rows': 5,
                'cols': 50,
            }
        ),
        error_messages={'required':'ë‚´ìš©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.'},
    )
```

### â€˜upload_toâ€™ argument

- ImageField()ì˜ upload_to ì¸ìë¥¼ ì‚¬ìš©í•´ ë¯¸ë””ì–´ íŒŒì¼ ì¶”ê°€ ê²½ë¡œ ì„¤ì •

```python
# 1
image = models.ImageField(blank=True, upload_to='images/')

# 2
image = models.ImageField(blank=True, upload_to='%Y/%m/%d/')

# 3
def articles_image_path(instance, filename):
	return f'images/{instance.user.username}/{filename}'

image = models.ImageField(blank=True, upload_to=articles_image_path)
```

### request.FILESê°€ ë‘ë²ˆì¬ ìœ„ì¹˜ ì¸ìì¸ ì´ìœ 

- ModelForm ìƒìœ„ í´ë˜ìŠ¤ BaseModelFormì˜ ìƒì„±ì í•¨ìˆ˜ í‚¤ì›Œë“œ ì¸ì

```python
class BaseModelForm(BaseForm):
	def __init__(self, data=None, **files=None**, auto_id='id_%s', prefix=None,
							 initial=None, error_class=ErrorList, label_suffix=None, 
               empty_permitted=False, instance=None, use_required_attribute=None,
               renderer=None):
```
